<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Source Code Review Checklist - Durj</title>
  <style>
    * { box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }
    .container { max-width: 1200px; margin: 0 auto; }
    h1 { color: #1a1a1a; border-bottom: 2px solid #3b82f6; padding-bottom: 10px; }
    .stats { background: #fff; padding: 15px 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); display: flex; gap: 30px; flex-wrap: wrap; }
    .stat { text-align: center; }
    .stat-value { font-size: 2em; font-weight: bold; color: #3b82f6; }
    .stat-label { color: #666; font-size: 0.9em; }
    .controls { background: #fff; padding: 15px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }
    .controls input[type="text"] { padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px; width: 300px; }
    .controls button { padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer; font-weight: 500; }
    .btn-primary { background: #3b82f6; color: white; }
    .btn-secondary { background: #6b7280; color: white; }
    .btn-success { background: #10b981; color: white; }
    .btn-danger { background: #ef4444; color: white; }
    .progress-container { background: #fff; padding: 15px 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .progress-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
    .progress-title { font-weight: 600; color: #1f2937; }
    .progress-percent { font-size: 1.5em; font-weight: bold; color: #3b82f6; }
    .progress-bar { height: 24px; background: #e5e7eb; border-radius: 12px; overflow: hidden; position: relative; }
    .progress-fill { height: 100%; background: linear-gradient(90deg, #3b82f6, #10b981); border-radius: 12px; transition: width 0.3s ease; }
    .progress-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 0.85em; font-weight: 600; color: #374151; }
    .legend { display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap; }
    .legend-item { display: flex; align-items: center; gap: 5px; font-size: 0.85em; }
    .legend-color { width: 12px; height: 12px; border-radius: 2px; }
    .keep { background: #dcfce7; }
    .delete { background: #fee2e2; }
    .review { background: #fef3c7; }

    /* Tree container */
    .tree-container { background: #fff; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); padding: 15px; }

    /* Tree node styles */
    .tree-node { margin-left: 0; }
    .tree-node .tree-node { margin-left: 20px; border-left: 1px dashed #d1d5db; }
    .tree-children { position: relative; }

    /* Folder header */
    .folder-header {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 6px 8px;
      cursor: pointer;
      border-radius: 4px;
      user-select: none;
      position: relative;
    }
    .folder-header:hover { background: #f3f4f6; }
    .folder-header .arrow {
      width: 16px;
      height: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      color: #6b7280;
      transition: transform 0.15s;
      flex-shrink: 0;
    }
    .folder-header.collapsed .arrow { transform: rotate(-90deg); }
    .folder-icon { font-size: 14px; flex-shrink: 0; }
    .folder-name { font-weight: 500; color: #374151; font-size: 0.9em; }
    .folder-count {
      background: #e5e7eb;
      padding: 1px 6px;
      border-radius: 10px;
      font-size: 0.75em;
      color: #6b7280;
      margin-left: auto;
    }
    .folder-progress {
      font-size: 0.75em;
      color: #059669;
      margin-left: 8px;
    }

    /* Tree children container */
    .tree-children.collapsed { display: none; }

    /* File item in tree */
    .file-item {
      display: flex;
      align-items: center;
      padding: 5px 8px;
      margin-left: 24px;
      border-radius: 4px;
      position: relative;
    }
    .file-item:hover { background: #f9fafb; }
    .file-item::before {
      content: '';
      position: absolute;
      left: -12px;
      top: 50%;
      width: 12px;
      height: 1px;
      background: #d1d5db;
    }
    .file-item input[type="checkbox"] { width: 16px; height: 16px; margin-right: 8px; cursor: pointer; flex-shrink: 0; }
    .file-item label {
      flex: 1;
      cursor: pointer;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 0.8em;
      color: #374151;
      word-break: break-all;
    }
    .file-item.checked label { color: #9ca3af; text-decoration: line-through; }
    .file-item .status { margin-left: 8px; flex-shrink: 0; }
    .file-item select { padding: 3px 6px; border: 1px solid #ddd; border-radius: 4px; font-size: 0.75em; }
    .file-item.status-keep { background: #f0fdf4; }
    .file-item.status-delete { background: #fef2f2; }
    .file-item.status-review { background: #fffbeb; }

    /* Quick nav */
    .quick-nav {
      background: #fff;
      padding: 10px 15px;
      border-radius: 8px;
      margin-bottom: 15px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .quick-nav-label { font-size: 0.85em; color: #6b7280; margin-bottom: 8px; }
    .quick-nav-buttons { display: flex; gap: 6px; flex-wrap: wrap; }
    .quick-nav-btn {
      padding: 4px 10px;
      background: #f3f4f6;
      border: 1px solid #e5e7eb;
      border-radius: 4px;
      font-size: 0.8em;
      cursor: pointer;
      color: #374151;
    }
    .quick-nav-btn:hover { background: #e5e7eb; }
    .quick-nav-btn.active { background: #3b82f6; color: white; border-color: #3b82f6; }

    @media (max-width: 600px) {
      .controls input[type="text"] { width: 100%; }
      .stats { flex-direction: column; gap: 15px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Source Code Review Checklist</h1>
    <p>Generated: 2026-01-28 | Total Files: <strong>948</strong> (Updated: tree navigation added)</p>

    <div class="stats">
      <div class="stat">
        <div class="stat-value" id="totalFiles">948</div>
        <div class="stat-label">Total Files</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="reviewedCount">0</div>
        <div class="stat-label">Reviewed</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="keepCount">0</div>
        <div class="stat-label">Keep</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="deleteCount">0</div>
        <div class="stat-label">Delete</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="reviewCount">0</div>
        <div class="stat-label">Needs Review</div>
      </div>
    </div>

    <div class="progress-container">
      <div class="progress-header">
        <span class="progress-title">Review Progress</span>
        <span class="progress-percent" id="progressPercent">0%</span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
        <span class="progress-text" id="progressText">0 / 948 files reviewed</span>
      </div>
    </div>

    <div class="legend">
      <div class="legend-item"><div class="legend-color keep"></div> Keep</div>
      <div class="legend-item"><div class="legend-color delete"></div> Delete</div>
      <div class="legend-item"><div class="legend-color review"></div> Needs Review</div>
    </div>

    <div class="controls">
      <input type="text" id="searchInput" placeholder="Search files..." onkeyup="filterFiles()">
      <select id="filterSelect" onchange="filterFiles()" style="padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
        <option value="all">All Files</option>
        <option value="reviewed">Reviewed Only</option>
        <option value="unreviewed">Unreviewed Only</option>
        <option value="keep">Keep Only</option>
        <option value="delete">Delete Only</option>
        <option value="review">Needs Review Only</option>
      </select>
      <button class="btn-secondary" onclick="expandAll()">Expand All</button>
      <button class="btn-secondary" onclick="collapseAll()">Collapse All</button>
      <button class="btn-secondary" onclick="expandToLevel(1)">Level 1</button>
      <button class="btn-secondary" onclick="expandToLevel(2)">Level 2</button>
      <button class="btn-secondary" onclick="expandToLevel(3)">Level 3</button>
      <button class="btn-success" onclick="saveProgress()">Save Progress</button>
      <button class="btn-primary" onclick="loadProgress()">Load Progress</button>
      <button class="btn-danger" onclick="exportReport()">Export Report</button>
    </div>

    <div class="quick-nav">
      <div class="quick-nav-label">Quick Navigation:</div>
      <div class="quick-nav-buttons" id="quickNavButtons"></div>
    </div>

    <div class="tree-container" id="fileTree"></div>
  </div>

  <script>
    const files = [
      // app - (marketing)
      "src/app/(marketing)/cookies/page.tsx",
      "src/app/(marketing)/layout.tsx",
      "src/app/(marketing)/page.tsx",
      "src/app/(marketing)/privacy/page.tsx",
      "src/app/(marketing)/terms/page.tsx",
      // app - admin
      "src/app/admin/(hr)/employees/[id]/edit/page.tsx",
      "src/app/admin/(hr)/employees/[id]/page.tsx",
      "src/app/admin/(hr)/employees/change-requests/client.tsx",
      "src/app/admin/(hr)/employees/change-requests/page.tsx",
      "src/app/admin/(hr)/employees/deleted/deleted-employees-table.tsx",
      "src/app/admin/(hr)/employees/deleted/page.tsx",
      "src/app/admin/(hr)/employees/document-expiry/client.tsx",
      "src/app/admin/(hr)/employees/document-expiry/page.tsx",
      "src/app/admin/(hr)/employees/loading.tsx",
      "src/app/admin/(hr)/employees/new/page.tsx",
      "src/app/admin/(hr)/employees/page.tsx",
      "src/app/admin/(hr)/employees/team-client.tsx",
      "src/app/admin/(hr)/error.tsx",
      "src/app/admin/(hr)/layout.tsx",
      "src/app/admin/(hr)/layout-client.tsx",
      "src/app/admin/(hr)/leave/balances/client.tsx",
      "src/app/admin/(hr)/leave/balances/page.tsx",
      "src/app/admin/(hr)/leave/calendar/client.tsx",
      "src/app/admin/(hr)/leave/calendar/page.tsx",
      "src/app/admin/(hr)/leave/requests/[id]/page.tsx",
      "src/app/admin/(hr)/leave/requests/loading.tsx",
      "src/app/admin/(hr)/leave/requests/new/page.tsx",
      "src/app/admin/(hr)/leave/requests/page.tsx",
      "src/app/admin/(hr)/payroll/gratuity/page.tsx",
      "src/app/admin/(hr)/payroll/loans/[id]/page.tsx",
      "src/app/admin/(hr)/payroll/loans/new/page.tsx",
      "src/app/admin/(hr)/payroll/loans/page.tsx",
      "src/app/admin/(hr)/payroll/page.tsx",
      "src/app/admin/(hr)/payroll/payslips/[id]/page.tsx",
      "src/app/admin/(hr)/payroll/payslips/page.tsx",
      "src/app/admin/(hr)/payroll/runs/[id]/page.tsx",
      "src/app/admin/(hr)/payroll/runs/new/page.tsx",
      "src/app/admin/(hr)/payroll/runs/page.tsx",
      "src/app/admin/(hr)/payroll/salary-structures/[id]/edit/page.tsx",
      "src/app/admin/(hr)/payroll/salary-structures/new/page.tsx",
      "src/app/admin/(hr)/payroll/salary-structures/page.tsx",
      "src/app/admin/(operations)/asset-requests/[id]/page.tsx",
      "src/app/admin/(operations)/asset-requests/loading.tsx",
      "src/app/admin/(operations)/asset-requests/page.tsx",
      "src/app/admin/(operations)/assets/[id]/edit/loading.tsx",
      "src/app/admin/(operations)/assets/[id]/edit/page.tsx",
      "src/app/admin/(operations)/assets/[id]/loading.tsx",
      "src/app/admin/(operations)/assets/[id]/page.tsx",
      "src/app/admin/(operations)/assets/deleted/deleted-assets-table.tsx",
      "src/app/admin/(operations)/assets/deleted/page.tsx",
      "src/app/admin/(operations)/assets/loading.tsx",
      "src/app/admin/(operations)/assets/new/page.tsx",
      "src/app/admin/(operations)/assets/page.tsx",
      "src/app/admin/(operations)/error.tsx",
      "src/app/admin/(operations)/subscriptions/[id]/edit/page.tsx",
      "src/app/admin/(operations)/subscriptions/[id]/page.tsx",
      "src/app/admin/(operations)/subscriptions/loading.tsx",
      "src/app/admin/(operations)/subscriptions/new/page.tsx",
      "src/app/admin/(operations)/subscriptions/page.tsx",
      "src/app/admin/(operations)/suppliers/[id]/edit/page.tsx",
      "src/app/admin/(operations)/suppliers/[id]/page.tsx",
      "src/app/admin/(operations)/suppliers/loading.tsx",
      "src/app/admin/(operations)/suppliers/page.tsx",
      "src/app/admin/(projects)/error.tsx",
      "src/app/admin/(projects)/spend-requests/[id]/page.tsx",
      "src/app/admin/(projects)/spend-requests/loading.tsx",
      "src/app/admin/(projects)/spend-requests/page.tsx",
      "src/app/admin/(system)/activity/page.tsx",
      "src/app/admin/(system)/alerts/client.tsx",
      "src/app/admin/(system)/alerts/page.tsx",
      "src/app/admin/(system)/approvals/[id]/page.tsx",
      "src/app/admin/(system)/approvals/page.tsx",
      "src/app/admin/(system)/backups/client.tsx",
      "src/app/admin/(system)/backups/page.tsx",
      "src/app/admin/(system)/billing/page.tsx",
      "src/app/admin/(system)/calendar/client.tsx",
      "src/app/admin/(system)/calendar/page.tsx",
      "src/app/admin/(system)/dashboard/page.tsx",
      "src/app/admin/(system)/documents/[id]/edit/page.tsx",
      "src/app/admin/(system)/documents/[id]/page.tsx",
      "src/app/admin/(system)/documents/new/page.tsx",
      "src/app/admin/(system)/documents/page.tsx",
      "src/app/admin/(system)/email-logs/client.tsx",
      "src/app/admin/(system)/email-logs/page.tsx",
      "src/app/admin/(system)/error.tsx",
      "src/app/admin/(system)/help/page.tsx",
      "src/app/admin/(system)/integrations/whatsapp/client.tsx",
      "src/app/admin/(system)/integrations/whatsapp/page.tsx",
      "src/app/admin/(system)/reports/page.tsx",
      "src/app/admin/(system)/settings/page.tsx",
      "src/app/admin/(system)/users/[id]/page.tsx",
      "src/app/admin/(system)/users/deleted/deleted-users-table.tsx",
      "src/app/admin/(system)/users/deleted/page.tsx",
      "src/app/admin/(system)/users/invite/page.tsx",
      "src/app/admin/(system)/users/page.tsx",
      "src/app/admin/error.tsx",
      "src/app/admin/layout.tsx",
      "src/app/admin/navigation.tsx",
      // app - api
      "src/app/api/activity/route.ts",
      "src/app/api/ai/audit-logs/route.ts",
      "src/app/api/ai/chat/route.ts",
      "src/app/api/alerts/count/route.ts",
      "src/app/api/alerts/dismiss/route.ts",
      "src/app/api/alerts/route.ts",
      "src/app/api/approvals/[id]/approve/route.ts",
      "src/app/api/approvals/[id]/reject/route.ts",
      "src/app/api/approvals/[id]/route.ts",
      "src/app/api/approvals/request/route.ts",
      "src/app/api/approvals/route.ts",
      "src/app/api/asset-requests/[id]/approve/route.ts",
      "src/app/api/asset-requests/[id]/reject/route.ts",
      "src/app/api/asset-requests/[id]/route.ts",
      "src/app/api/asset-requests/route.ts",
      "src/app/api/assets/[id]/assign/route.ts",
      "src/app/api/assets/[id]/audit/route.ts",
      "src/app/api/assets/[id]/depreciation/route.ts",
      "src/app/api/assets/[id]/history/route.ts",
      "src/app/api/assets/[id]/restore/route.ts",
      "src/app/api/assets/[id]/return/route.ts",
      "src/app/api/assets/[id]/route.ts",
      "src/app/api/assets/batch-update/route.ts",
      "src/app/api/assets/codes/next/route.ts",
      "src/app/api/assets/codes/route.ts",
      "src/app/api/assets/export/route.ts",
      "src/app/api/assets/import/route.ts",
      "src/app/api/assets/route.ts",
      "src/app/api/assets/warranty-expiry/route.ts",
      "src/app/api/auth/[...nextauth]/route.ts",
      "src/app/api/auth/change-password/route.ts",
      "src/app/api/auth/check/route.ts",
      "src/app/api/auth/oauth/azure/callback/route.ts",
      "src/app/api/auth/oauth/azure/route.ts",
      "src/app/api/auth/oauth/google/callback/route.ts",
      "src/app/api/auth/oauth/google/route.ts",
      "src/app/api/auth/profile/route.ts",
      "src/app/api/auth/signup/route.ts",
      "src/app/api/backups/[id]/download/route.ts",
      "src/app/api/backups/[id]/route.ts",
      "src/app/api/backups/route.ts",
      "src/app/api/calendar/events/route.ts",
      "src/app/api/cron/employee-expiry/route.ts",
      "src/app/api/cron/subscriptions/route.ts",
      "src/app/api/cron/warranty-expiry/route.ts",
      "src/app/api/documents/[id]/download/route.ts",
      "src/app/api/documents/[id]/route.ts",
      "src/app/api/documents/[id]/upload/route.ts",
      "src/app/api/documents/expiry/route.ts",
      "src/app/api/documents/route.ts",
      "src/app/api/email-logs/route.ts",
      "src/app/api/email-logs/stats/route.ts",
      "src/app/api/email/test/route.ts",
      "src/app/api/employees/[id]/archive/route.ts",
      "src/app/api/employees/[id]/documents/expiry/route.ts",
      "src/app/api/employees/[id]/documents/route.ts",
      "src/app/api/employees/[id]/gratuity/route.ts",
      "src/app/api/employees/[id]/links/route.ts",
      "src/app/api/employees/[id]/milestones/route.ts",
      "src/app/api/employees/[id]/restore/route.ts",
      "src/app/api/employees/[id]/route.ts",
      "src/app/api/employees/[id]/salary-history/route.ts",
      "src/app/api/employees/change-requests/[id]/route.ts",
      "src/app/api/employees/change-requests/route.ts",
      "src/app/api/employees/codes/next/route.ts",
      "src/app/api/employees/codes/route.ts",
      "src/app/api/employees/export/route.ts",
      "src/app/api/employees/import/route.ts",
      "src/app/api/employees/route.ts",
      "src/app/api/help/route.ts",
      "src/app/api/invitations/[token]/route.ts",
      "src/app/api/leave/balances/route.ts",
      "src/app/api/leave/calendar/route.ts",
      "src/app/api/leave/requests/[id]/approve/route.ts",
      "src/app/api/leave/requests/[id]/reject/route.ts",
      "src/app/api/leave/requests/[id]/route.ts",
      "src/app/api/leave/requests/route.ts",
      "src/app/api/leave/types/route.ts",
      "src/app/api/loans/[id]/repayments/route.ts",
      "src/app/api/loans/[id]/route.ts",
      "src/app/api/loans/route.ts",
      "src/app/api/me/asset-requests/route.ts",
      "src/app/api/me/assets/route.ts",
      "src/app/api/me/leave-balance/route.ts",
      "src/app/api/me/leave-requests/route.ts",
      "src/app/api/me/notifications/[id]/read/route.ts",
      "src/app/api/me/notifications/route.ts",
      "src/app/api/me/profile/route.ts",
      "src/app/api/me/route.ts",
      "src/app/api/me/spend-requests/route.ts",
      "src/app/api/me/subscriptions/route.ts",
      "src/app/api/me/suppliers/route.ts",
      "src/app/api/notifications/count/route.ts",
      "src/app/api/onboarding/complete/route.ts",
      "src/app/api/onboarding/progress/route.ts",
      "src/app/api/organizations/route.ts",
      "src/app/api/organizations/slug/route.ts",
      "src/app/api/payroll/payslips/[id]/route.ts",
      "src/app/api/payroll/runs/[id]/finalize/route.ts",
      "src/app/api/payroll/runs/[id]/generate-wps/route.ts",
      "src/app/api/payroll/runs/[id]/preview/route.ts",
      "src/app/api/payroll/runs/[id]/process/route.ts",
      "src/app/api/payroll/runs/[id]/route.ts",
      "src/app/api/payroll/runs/route.ts",
      "src/app/api/payroll/salary-structures/[id]/route.ts",
      "src/app/api/payroll/salary-structures/route.ts",
      "src/app/api/qnas/route.ts",
      "src/app/api/reports/[type]/route.ts",
      "src/app/api/settings/asset-categories/route.ts",
      "src/app/api/settings/asset-type-mappings/route.ts",
      "src/app/api/settings/branding/route.ts",
      "src/app/api/settings/code-format/route.ts",
      "src/app/api/settings/company/route.ts",
      "src/app/api/settings/depreciation-categories/route.ts",
      "src/app/api/settings/employment-defaults/route.ts",
      "src/app/api/settings/exchange-rates/route.ts",
      "src/app/api/settings/leave-types/route.ts",
      "src/app/api/settings/locations/route.ts",
      "src/app/api/settings/modules/route.ts",
      "src/app/api/settings/oauth/azure/route.ts",
      "src/app/api/settings/oauth/azure/test/route.ts",
      "src/app/api/settings/oauth/google/route.ts",
      "src/app/api/settings/oauth/google/test/route.ts",
      "src/app/api/settings/organization/route.ts",
      "src/app/api/settings/payroll/route.ts",
      "src/app/api/settings/permissions/route.ts",
      "src/app/api/settings/public-holidays/route.ts",
      "src/app/api/settings/security/route.ts",
      "src/app/api/settings/whatsapp/route.ts",
      "src/app/api/spend-requests/[id]/approve/route.ts",
      "src/app/api/spend-requests/[id]/pdf/route.ts",
      "src/app/api/spend-requests/[id]/reject/route.ts",
      "src/app/api/spend-requests/[id]/route.ts",
      "src/app/api/spend-requests/codes/next/route.ts",
      "src/app/api/spend-requests/codes/route.ts",
      "src/app/api/spend-requests/export/route.ts",
      "src/app/api/spend-requests/route.ts",
      "src/app/api/subscriptions/[id]/cancel/route.ts",
      "src/app/api/subscriptions/[id]/history/route.ts",
      "src/app/api/subscriptions/[id]/reactivate/route.ts",
      "src/app/api/subscriptions/[id]/route.ts",
      "src/app/api/subscriptions/codes/next/route.ts",
      "src/app/api/subscriptions/codes/route.ts",
      "src/app/api/subscriptions/export/route.ts",
      "src/app/api/subscriptions/import/route.ts",
      "src/app/api/subscriptions/route.ts",
      "src/app/api/super-admin/ai-audit-logs/route.ts",
      "src/app/api/super-admin/ai-usage/[orgId]/route.ts",
      "src/app/api/super-admin/ai-usage/route.ts",
      "src/app/api/super-admin/backups/cron/route.ts",
      "src/app/api/super-admin/backups/route.ts",
      "src/app/api/super-admin/impersonate/route.ts",
      "src/app/api/super-admin/login/route.ts",
      "src/app/api/super-admin/organizations/[id]/route.ts",
      "src/app/api/super-admin/organizations/route.ts",
      "src/app/api/super-admin/stats/route.ts",
      "src/app/api/super-admin/users/route.ts",
      "src/app/api/suppliers/[id]/route.ts",
      "src/app/api/suppliers/export/route.ts",
      "src/app/api/suppliers/import/route.ts",
      "src/app/api/suppliers/route.ts",
      "src/app/api/suppliers/share/[token]/route.ts",
      "src/app/api/upload/route.ts",
      "src/app/api/users/[id]/2fa/disable/route.ts",
      "src/app/api/users/[id]/2fa/generate/route.ts",
      "src/app/api/users/[id]/2fa/setup/route.ts",
      "src/app/api/users/[id]/2fa/verify/route.ts",
      "src/app/api/users/[id]/permissions/route.ts",
      "src/app/api/users/[id]/restore/route.ts",
      "src/app/api/users/[id]/role/route.ts",
      "src/app/api/users/[id]/route.ts",
      "src/app/api/users/export-pdf/[id]/route.ts",
      "src/app/api/users/export/route.ts",
      "src/app/api/users/invite/route.ts",
      "src/app/api/users/route.ts",
      "src/app/api/whatsapp/actions/[token]/route.ts",
      "src/app/api/whatsapp/webhook/route.ts",
      // app - employee
      "src/app/employee/(hr)/leave/history/page.tsx",
      "src/app/employee/(hr)/leave/page.tsx",
      "src/app/employee/(hr)/leave/request/page.tsx",
      "src/app/employee/(hr)/payslips/page.tsx",
      "src/app/employee/(operations)/asset-requests/[id]/page.tsx",
      "src/app/employee/(operations)/asset-requests/new/page.tsx",
      "src/app/employee/(operations)/asset-requests/page.tsx",
      "src/app/employee/(operations)/assets/[id]/page.tsx",
      "src/app/employee/(operations)/assets/page.tsx",
      "src/app/employee/(operations)/subscriptions/[id]/page.tsx",
      "src/app/employee/(operations)/subscriptions/page.tsx",
      "src/app/employee/(operations)/suppliers/[id]/page.tsx",
      "src/app/employee/(operations)/suppliers/page.tsx",
      "src/app/employee/(projects)/spend-requests/[id]/page.tsx",
      "src/app/employee/(projects)/spend-requests/new/page.tsx",
      "src/app/employee/(projects)/spend-requests/page.tsx",
      "src/app/employee/(system)/approvals/[id]/page.tsx",
      "src/app/employee/(system)/approvals/page.tsx",
      "src/app/employee/(system)/dashboard/page.tsx",
      "src/app/employee/(system)/profile/page.tsx",
      "src/app/employee/layout.tsx",
      "src/app/employee/navigation.tsx",
      // app - login
      "src/app/login/actions.ts",
      "src/app/login/form.tsx",
      "src/app/login/page.tsx",
      "src/app/login/tenant-options.tsx",
      "src/app/login/tenant-social-buttons.tsx",
      // app - misc
      "src/app/error.tsx",
      "src/app/favicon.ico",
      "src/app/globals.css",
      "src/app/invite/[token]/page.tsx",
      "src/app/layout.tsx",
      "src/app/not-found.tsx",
      "src/app/onboarding/page.tsx",
      "src/app/providers.tsx",
      "src/app/signup/page.tsx",
      "src/app/supplier/[token]/page.tsx",
      // app - super-admin
      "src/app/super-admin/ai-management/client.tsx",
      "src/app/super-admin/ai-management/page.tsx",
      "src/app/super-admin/backups/client.tsx",
      "src/app/super-admin/backups/page.tsx",
      "src/app/super-admin/layout.tsx",
      "src/app/super-admin/organizations/client.tsx",
      "src/app/super-admin/organizations/page.tsx",
      "src/app/super-admin/page.tsx",
      "src/app/super-admin/users/client.tsx",
      "src/app/super-admin/users/page.tsx",
      // app - two-factor
      "src/app/two-factor/backup-codes/page.tsx",
      "src/app/two-factor/setup/page.tsx",
      "src/app/two-factor/verify/page.tsx",
      // components - forms
      "src/components/forms/asset-form.tsx",
      "src/components/forms/asset-request-form.tsx",
      "src/components/forms/document-form.tsx",
      "src/components/forms/employee-form.tsx",
      "src/components/forms/index.ts",
      "src/components/forms/leave-request-form.tsx",
      "src/components/forms/loan-form.tsx",
      "src/components/forms/payroll-run-form.tsx",
      "src/components/forms/salary-structure-form.tsx",
      "src/components/forms/spend-request-form.tsx",
      "src/components/forms/subscription-form.tsx",
      "src/components/forms/supplier-form.tsx",
      // components - layout
      "src/components/layout/admin-breadcrumb.tsx",
      "src/components/layout/app-sidebar.tsx",
      "src/components/layout/collapsible-sidebar.tsx",
      "src/components/layout/index.ts",
      "src/components/layout/marketing-footer.tsx",
      "src/components/layout/mobile-nav.tsx",
      "src/components/layout/navbar.tsx",
      "src/components/layout/notification-bell.tsx",
      "src/components/layout/page-container.tsx",
      "src/components/layout/sidebar-nav-section.tsx",
      // components - shared
      "src/components/shared/approval-dialog.tsx",
      "src/components/shared/approval-history.tsx",
      "src/components/shared/audit-history.tsx",
      "src/components/shared/confirm-dialog.tsx",
      "src/components/shared/data-table-column-header.tsx",
      "src/components/shared/data-table-filters.tsx",
      "src/components/shared/data-table-wrapper.tsx",
      "src/components/shared/empty-state.tsx",
      "src/components/shared/file-preview.tsx",
      "src/components/shared/file-uploader.tsx",
      "src/components/shared/form-section.tsx",
      "src/components/shared/index.ts",
      "src/components/shared/info-item.tsx",
      "src/components/shared/multi-select.tsx",
      "src/components/shared/readonly-field.tsx",
      "src/components/shared/record-metadata.tsx",
      "src/components/shared/search-input.tsx",
      "src/components/shared/timeline.tsx",
      // components - ui
      "src/components/ui/accordion.tsx",
      "src/components/ui/alert-dialog.tsx",
      "src/components/ui/alert.tsx",
      "src/components/ui/avatar.tsx",
      "src/components/ui/badge.tsx",
      "src/components/ui/breadcrumb.tsx",
      "src/components/ui/button.tsx",
      "src/components/ui/calendar.tsx",
      "src/components/ui/card.tsx",
      "src/components/ui/chart.tsx",
      "src/components/ui/checkbox.tsx",
      "src/components/ui/collapsible.tsx",
      "src/components/ui/combobox.tsx",
      "src/components/ui/command.tsx",
      "src/components/ui/date-range-picker.tsx",
      "src/components/ui/dialog.tsx",
      "src/components/ui/dropdown-menu.tsx",
      "src/components/ui/error-boundary.tsx",
      "src/components/ui/form.tsx",
      "src/components/ui/index.ts",
      "src/components/ui/input.tsx",
      "src/components/ui/label.tsx",
      "src/components/ui/page-header.tsx",
      "src/components/ui/popover.tsx",
      "src/components/ui/progress.tsx",
      "src/components/ui/radio-group.tsx",
      "src/components/ui/scroll-area.tsx",
      "src/components/ui/select.tsx",
      "src/components/ui/separator.tsx",
      "src/components/ui/sheet.tsx",
      "src/components/ui/sidebar.tsx",
      "src/components/ui/skeleton.tsx",
      "src/components/ui/status-badge.tsx",
      "src/components/ui/switch.tsx",
      "src/components/ui/table-skeleton.tsx",
      "src/components/ui/table.tsx",
      "src/components/ui/tabs.tsx",
      "src/components/ui/textarea.tsx",
      "src/components/ui/toast.tsx",
      "src/components/ui/toaster.tsx",
      "src/components/ui/toggle-group.tsx",
      "src/components/ui/toggle.tsx",
      "src/components/ui/tooltip.tsx",
      // features - approvals
      "src/features/approvals/components/approval-actions.tsx",
      "src/features/approvals/components/approval-list-client.tsx",
      "src/features/approvals/components/approval-list-table.tsx",
      "src/features/approvals/components/approval-status-badge.tsx",
      "src/features/approvals/components/approval-workflow-status.tsx",
      "src/features/approvals/components/index.ts",
      "src/features/approvals/lib/approval-service.ts",
      "src/features/approvals/lib/index.ts",
      "src/features/approvals/validations/approvals.ts",
      // features - asset-requests
      "src/features/asset-requests/components/asset-request-actions.tsx",
      "src/features/asset-requests/components/asset-request-detail.tsx",
      "src/features/asset-requests/components/asset-request-list-client.tsx",
      "src/features/asset-requests/components/asset-request-list-table.tsx",
      "src/features/asset-requests/components/index.ts",
      "src/features/asset-requests/lib/asset-request-create.ts",
      "src/features/asset-requests/lib/index.ts",
      "src/features/asset-requests/validations/asset-requests.ts",
      // features - assets
      "src/features/assets/components/asset-actions.tsx",
      "src/features/assets/components/asset-assignment-dialog.tsx",
      "src/features/assets/components/asset-audit-dialog.tsx",
      "src/features/assets/components/asset-detail.tsx",
      "src/features/assets/components/asset-history.tsx",
      "src/features/assets/components/asset-list-client.tsx",
      "src/features/assets/components/asset-list-table.tsx",
      "src/features/assets/components/asset-warranty-card.tsx",
      "src/features/assets/components/bulk-asset-edit-dialog.tsx",
      "src/features/assets/components/delete-asset-button.tsx",
      "src/features/assets/components/depreciation-display.tsx",
      "src/features/assets/components/employee-asset-list-table.tsx",
      "src/features/assets/components/index.ts",
      "src/features/assets/components/restore-asset-button.tsx",
      "src/features/assets/lib/asset-assignment.ts",
      "src/features/assets/lib/asset-import.ts",
      "src/features/assets/lib/depreciation.ts",
      "src/features/assets/lib/index.ts",
      "src/features/assets/validations/assets.ts",
      // features - documents
      "src/features/documents/components/document-actions.tsx",
      "src/features/documents/components/document-detail.tsx",
      "src/features/documents/components/document-list-client.tsx",
      "src/features/documents/components/document-list-table.tsx",
      "src/features/documents/components/index.ts",
      "src/features/documents/validations/documents.ts",
      // features - employees
      "src/features/employees/components/delete-employee-button.tsx",
      "src/features/employees/components/employee-actions.tsx",
      "src/features/employees/components/employee-change-request-dialog.tsx",
      "src/features/employees/components/employee-detail.tsx",
      "src/features/employees/components/employee-leave-section.tsx",
      "src/features/employees/components/employee-links.tsx",
      "src/features/employees/components/employee-list-client.tsx",
      "src/features/employees/components/employee-list-table.tsx",
      "src/features/employees/components/employee-milestones.tsx",
      "src/features/employees/components/employee-notice-period.tsx",
      "src/features/employees/components/employee-salary-history.tsx",
      "src/features/employees/components/index.ts",
      "src/features/employees/components/restore-employee-button.tsx",
      "src/features/employees/lib/employee-change-request.ts",
      "src/features/employees/lib/employee-expiry-check.ts",
      "src/features/employees/lib/employee-import.ts",
      "src/features/employees/lib/employment-defaults.ts",
      "src/features/employees/lib/index.ts",
      "src/features/employees/lib/work-milestones.ts",
      "src/features/employees/validations/employees.ts",
      // features - leave
      "src/features/leave/components/employee-leave-form.tsx",
      "src/features/leave/components/employee-leave-list.tsx",
      "src/features/leave/components/index.ts",
      "src/features/leave/components/leave-actions.tsx",
      "src/features/leave/components/leave-balance-card.tsx",
      "src/features/leave/components/leave-balance-table.tsx",
      "src/features/leave/components/leave-calendar.tsx",
      "src/features/leave/components/leave-request-detail.tsx",
      "src/features/leave/components/leave-request-list-client.tsx",
      "src/features/leave/components/leave-request-list-table.tsx",
      "src/features/leave/lib/index.ts",
      "src/features/leave/lib/leave-balance.ts",
      "src/features/leave/lib/leave-policy.ts",
      "src/features/leave/validations/leave.ts",
      // features - notifications
      "src/features/notifications/lib/index.ts",
      "src/features/notifications/lib/notification-service.ts",
      "src/features/notifications/validations/notifications.ts",
      // features - onboarding
      "src/features/onboarding/lib/index.ts",
      "src/features/onboarding/lib/progress-tracker.ts",
      // features - payroll
      "src/features/payroll/components/index.ts",
      "src/features/payroll/components/loan-actions.tsx",
      "src/features/payroll/components/payroll-workflow-actions.tsx",
      "src/features/payroll/lib/gratuity.ts",
      "src/features/payroll/lib/index.ts",
      "src/features/payroll/lib/leave-deduction.ts",
      "src/features/payroll/lib/preview.ts",
      "src/features/payroll/lib/utils.ts",
      "src/features/payroll/lib/wps.ts",
      "src/features/payroll/types/payroll.ts",
      "src/features/payroll/validations/payroll.ts",
      // features - settings
      "src/features/settings/components/asset-categories-settings.tsx",
      "src/features/settings/components/asset-type-mappings-settings.tsx",
      "src/features/settings/components/code-format-settings.tsx",
      "src/features/settings/components/data-export-import.tsx",
      "src/features/settings/components/depreciation-categories-settings.tsx",
      "src/features/settings/components/employment-defaults-settings.tsx",
      "src/features/settings/components/exchange-rate-settings.tsx",
      "src/features/settings/components/index.ts",
      "src/features/settings/components/leave-types-settings.tsx",
      "src/features/settings/components/locations-settings.tsx",
      "src/features/settings/components/payroll-settings.tsx",
      "src/features/settings/components/public-holidays-settings.tsx",
      // features - spend-requests
      "src/features/spend-requests/components/index.ts",
      "src/features/spend-requests/components/SpendRequestListClient.tsx",
      "src/features/spend-requests/components/SpendRequestListTable.tsx",
      "src/features/spend-requests/components/SpendRequestListTableFiltered.tsx",
      "src/features/spend-requests/components/StatusBadge.tsx",
      "src/features/spend-requests/lib/index.ts",
      "src/features/spend-requests/lib/spend-request-creation.ts",
      "src/features/spend-requests/lib/spend-request-utils.ts",
      // features - subscriptions
      "src/features/subscriptions/components/cards/cost-breakdown.tsx",
      "src/features/subscriptions/components/cards/history-timeline.tsx",
      "src/features/subscriptions/components/cards/subscription-renewal-display.tsx",
      "src/features/subscriptions/components/data-tables/employee-subscription-list-table.tsx",
      "src/features/subscriptions/components/data-tables/subscription-list-client.tsx",
      "src/features/subscriptions/components/data-tables/subscription-list-table.tsx",
      "src/features/subscriptions/components/data-tables/subscription-list-table-server-search.tsx",
      "src/features/subscriptions/components/forms/cancel-dialog.tsx",
      "src/features/subscriptions/components/forms/reactivate-dialog.tsx",
      "src/features/subscriptions/components/index.ts",
      "src/features/subscriptions/components/subscription-actions.tsx",
      "src/features/subscriptions/components/subscription-lifecycle-actions.tsx",
      "src/features/subscriptions/index.ts",
      "src/features/subscriptions/lib/billing-cycle.ts",
      "src/features/subscriptions/lib/index.ts",
      "src/features/subscriptions/lib/renewal-date.ts",
      "src/features/subscriptions/lib/subscription-import.ts",
      "src/features/subscriptions/lib/subscription-lifecycle.ts",
      "src/features/subscriptions/lib/subscription-utils.ts",
      "src/features/subscriptions/validations/index.ts",
      "src/features/subscriptions/validations/subscriptions.ts",
      // features - suppliers
      "src/features/suppliers/components/employee-supplier-list-table.tsx",
      "src/features/suppliers/components/index.ts",
      "src/features/suppliers/components/share-supplier-link-button.tsx",
      "src/features/suppliers/components/supplier-actions.tsx",
      "src/features/suppliers/components/supplier-list-client.tsx",
      "src/features/suppliers/components/supplier-list-table.tsx",
      "src/features/suppliers/components/supplier-list-table-filtered.tsx",
      "src/features/suppliers/components/supplier-list-table-server-search.tsx",
      "src/features/suppliers/constants/categories.ts",
      "src/features/suppliers/constants/index.ts",
      "src/features/suppliers/index.ts",
      "src/features/suppliers/lib/index.ts",
      "src/features/suppliers/lib/supplier-utils.ts",
      "src/features/suppliers/validations/index.ts",
      "src/features/suppliers/validations/suppliers.ts",
      // features - users
      "src/features/users/components/delete-user-button.tsx",
      "src/features/users/components/export-user-pdf-button.tsx",
      "src/features/users/components/index.ts",
      "src/features/users/components/restore-user-button.tsx",
      "src/features/users/components/user-actions.tsx",
      "src/features/users/components/user-asset-history.tsx",
      "src/features/users/components/user-detail-actions.tsx",
      "src/features/users/components/user-list-client.tsx",
      "src/features/users/components/user-subscription-history.tsx",
      "src/features/users/validations/users.ts",
      // hooks
      "src/hooks/use-auto-save.tsx",
      "src/hooks/use-client-data-table.ts",
      "src/hooks/use-permission.ts",
      "src/hooks/use-subdomain.ts",
      "src/hooks/use-tenant-branding.ts",
      // lib - access-control
      "src/lib/access-control/index.ts",
      "src/lib/access-control/manager-filter.ts",
      "src/lib/access-control/permissions.ts",
      "src/lib/access-control/permission-service.ts",
      "src/lib/access-control/role-utils.ts",
      "src/lib/access-control/seed-permissions.ts",
      // lib - ai
      "src/lib/ai/audit-logger.ts",
      "src/lib/ai/budget-tracker.ts",
      "src/lib/ai/chat-service.ts",
      "src/lib/ai/functions.ts",
      "src/lib/ai/input-sanitizer.ts",
      "src/lib/ai/permissions.ts",
      "src/lib/ai/rate-limiter.ts",
      // lib - constants
      "src/lib/constants/index.ts",
      "src/lib/constants/status-config.ts",
      "src/lib/constants/limits.ts",
      "src/lib/constants/procurement-categories.ts",
      "src/lib/constants/ui-constants.ts",
      "src/lib/constants/dropdown-options.ts",
      // lib - core
      "src/lib/core/activity.ts",
      "src/lib/core/api-error-interceptor.ts",
      "src/lib/core/auth.ts",
      "src/lib/core/currency.ts",
      "src/lib/core/datetime/constants.ts",
      "src/lib/core/datetime/formatting.ts",
      "src/lib/core/datetime/index.ts",
      "src/lib/core/datetime/parsing.ts",
      "src/lib/core/datetime/timezone.ts",
      "src/lib/core/error-logger.ts",
      "src/lib/core/impersonation-check.ts",
      "src/lib/core/import-export/csv-utils.ts",
      "src/lib/core/import-export/export-utils.ts",
      "src/lib/core/import-export/import-utils.ts",
      "src/lib/core/import-export/index.ts",
      "src/lib/core/log.ts",
      "src/lib/core/prisma.ts",
      "src/lib/core/prisma-tenant.ts",
      "src/lib/core/utils.ts",
      // lib - data
      "src/lib/data/constants.ts",
      // lib - db
      "src/lib/db/pagination.ts",
      "src/lib/db/search-filter.ts",
      // lib - domains (note: employment-defaults moved to features/employees/lib)
      "src/lib/domains/index.ts",
      // lib - email
      "src/lib/email/client.ts",
      "src/lib/email/failure-handler.ts",
      "src/lib/email/index.ts",
      "src/lib/email/sender.ts",
      "src/lib/email/templates/asset-requests.ts",
      "src/lib/email/templates/email-failures.ts",
      "src/lib/email/templates/error-alerts.ts",
      "src/lib/email/templates/general.ts",
      "src/lib/email/templates/index.ts",
      "src/lib/email/utils.ts",
      // lib - help
      "src/lib/help/content/hr/employees.ts",
      "src/lib/help/content/hr/leave.ts",
      "src/lib/help/content/hr/payroll.ts",
      "src/lib/help/content/index.ts",
      "src/lib/help/content/operations/assets.ts",
      "src/lib/help/content/operations/subscriptions.ts",
      "src/lib/help/content/operations/suppliers.ts",
      "src/lib/help/content/projects/spend-requests.ts",
      "src/lib/help/content/system/approvals.ts",
      "src/lib/help/content/system/documents.ts",
      "src/lib/help/content/system/settings.ts",
      "src/lib/help/content/system/users.ts",
      "src/lib/help/help-categories.ts",
      "src/lib/help/help-types.ts",
      "src/lib/help/index.ts",
      // lib - hooks
      "src/lib/hooks/index.ts",
      "src/lib/hooks/use-leave-balance.ts",
      "src/lib/hooks/use-submit-action.ts",
      // lib - http
      "src/lib/http/approval-handler.ts",
      "src/lib/http/errors.ts",
      "src/lib/http/export-handler.ts",
      "src/lib/http/handler.ts",
      "src/lib/http/import-handler.ts",
      "src/lib/http/list-handler.ts",
      "src/lib/http/responses.ts",
      // lib - images
      "src/lib/images/index.ts",
      "src/lib/images/logo-inverse.ts",
      // lib - modules
      "src/lib/modules/access.ts",
      "src/lib/modules/index.ts",
      "src/lib/modules/registry.ts",
      "src/lib/modules/routes.generated.ts",
      "src/lib/modules/routes.ts",
      // lib - multi-tenant
      "src/lib/multi-tenant/custom-domain.ts",
      "src/lib/multi-tenant/feature-flags.ts",
      "src/lib/multi-tenant/index.ts",
      "src/lib/multi-tenant/limits.ts",
      "src/lib/multi-tenant/subdomain.ts",
      // lib - oauth
      "src/lib/oauth/azure.ts",
      "src/lib/oauth/google.ts",
      "src/lib/oauth/utils.ts",
      // lib - qnas
      "src/lib/qnas/client.ts",
      "src/lib/qnas/index.ts",
      "src/lib/qnas/types.ts",
      // lib - security
      "src/lib/security/account-lockout.ts",
      "src/lib/security/backup-encryption.ts",
      "src/lib/security/cron-auth.ts",
      "src/lib/security/csrf.ts",
      "src/lib/security/headers.ts",
      "src/lib/security/impersonation.ts",
      "src/lib/security/password-validation.ts",
      "src/lib/security/rateLimit.ts",
      "src/lib/security/sanity.ts",
      // lib - storage
      "src/lib/storage/cleanup.ts",
      "src/lib/storage/index.ts",
      "src/lib/storage/supabase.ts",
      // lib - two-factor
      "src/lib/two-factor/backup-codes.ts",
      "src/lib/two-factor/encryption.ts",
      "src/lib/two-factor/index.ts",
      "src/lib/two-factor/require-recent-2fa.ts",
      "src/lib/two-factor/totp.ts",
      // lib - types
      "src/lib/types/index.ts",
      "src/lib/types/leave.ts",
      "src/lib/types/tenant-branding.ts",
      // lib - utils
      "src/lib/utils/calendar-utils.ts",
      "src/lib/utils/code-prefix.ts",
      "src/lib/utils/json-utils.ts",
      "src/lib/utils/math-utils.ts",
      "src/lib/utils/service-account-detection.ts",
      "src/lib/utils/user-display.ts",
      "src/lib/utils/whatsapp-verification-check.ts",
      // lib - validations
      "src/lib/validations/core/index.ts",
      "src/lib/validations/core/upload.ts",
      "src/lib/validations/core/users.ts",
      "src/lib/validations/field-schemas.ts",
      "src/lib/validations/hr/index.ts",
      "src/lib/validations/operations/index.ts",
      "src/lib/validations/pagination-schema.ts",
      "src/lib/validations/patterns.ts",
      "src/lib/validations/projects/index.ts",
      "src/lib/validations/projects/spend-request.ts",
      "src/lib/validations/system/index.ts",
      "src/lib/validations/workflow-schemas.ts",
      // lib - whatsapp
      "src/lib/whatsapp/action-tokens.ts",
      "src/lib/whatsapp/approval-integration.ts",
      "src/lib/whatsapp/client.ts",
      "src/lib/whatsapp/config.ts",
      "src/lib/whatsapp/index.ts",
      "src/lib/whatsapp/send-notification.ts",
      "src/lib/whatsapp/templates.ts",
      "src/lib/whatsapp/types.ts",
      // middleware
      "src/middleware.ts",
    ];

    // Build tree structure from flat file list
    function buildTree(files) {
      const root = { name: 'src', children: {}, files: [] };

      files.forEach(filePath => {
        const parts = filePath.split('/');
        let current = root;

        // Navigate/create tree structure for directories
        for (let i = 0; i < parts.length - 1; i++) {
          const part = parts[i];
          if (!current.children[part]) {
            current.children[part] = { name: part, children: {}, files: [], path: parts.slice(0, i + 1).join('/') };
          }
          current = current.children[part];
        }

        // Add file to the final directory
        current.files.push(filePath);
      });

      return root.children['src'] || root;
    }

    // Count all files in a tree node (including nested)
    function countFiles(node) {
      let count = node.files.length;
      Object.values(node.children).forEach(child => {
        count += countFiles(child);
      });
      return count;
    }

    // Count checked files in a tree node
    function countCheckedFiles(node, path) {
      let count = 0;
      node.files.forEach(file => {
        const item = document.querySelector(`[data-file="${file}"]`);
        if (item && item.querySelector('input').checked) count++;
      });
      Object.values(node.children).forEach(child => {
        count += countCheckedFiles(child, child.path);
      });
      return count;
    }

    // Render the tree recursively
    function renderTree(node, container, level = 0) {
      const childNames = Object.keys(node.children).sort();

      childNames.forEach(name => {
        const child = node.children[name];
        const fileCount = countFiles(child);

        const treeNode = document.createElement('div');
        treeNode.className = 'tree-node';
        treeNode.dataset.path = child.path;
        treeNode.dataset.level = level;

        // Folder header
        const header = document.createElement('div');
        header.className = 'folder-header collapsed';
        header.innerHTML = `
          <span class="arrow">‚ñº</span>
          <span class="folder-icon">üìÅ</span>
          <span class="folder-name">${name}</span>
          <span class="folder-count">${fileCount}</span>
          <span class="folder-progress" data-path="${child.path}">0/${fileCount}</span>
        `;
        header.onclick = (e) => {
          e.stopPropagation();
          header.classList.toggle('collapsed');
          const children = treeNode.querySelector('.tree-children');
          if (children) children.classList.toggle('collapsed');
        };

        // Children container
        const childrenContainer = document.createElement('div');
        childrenContainer.className = 'tree-children collapsed';

        // Render nested folders and files recursively
        renderTree(child, childrenContainer, level + 1);

        treeNode.appendChild(header);
        treeNode.appendChild(childrenContainer);
        container.appendChild(treeNode);
      });

      // Render files directly at this level (if any)
      node.files.sort().forEach(file => {
        const item = document.createElement('div');
        item.className = 'file-item';
        item.dataset.file = file;

        const id = file.replace(/[^a-zA-Z0-9]/g, '_');
        const fileName = file.split('/').pop();
        item.innerHTML = `
          <input type="checkbox" id="${id}" onchange="toggleFile('${file}', this.checked)">
          <label for="${id}">${fileName}</label>
          <div class="status">
            <select onchange="setStatus('${file}', this.value)">
              <option value="">--</option>
              <option value="keep">Keep</option>
              <option value="delete">Delete</option>
              <option value="review">Review</option>
            </select>
          </div>
        `;
        container.appendChild(item);
      });
    }

    // Generate quick nav buttons for top-level folders
    function renderQuickNav() {
      const tree = buildTree(files);
      const navContainer = document.getElementById('quickNavButtons');
      navContainer.innerHTML = ''; // Clear existing buttons
      const topFolders = Object.keys(tree.children).sort();

      topFolders.forEach(folder => {
        const btn = document.createElement('button');
        btn.className = 'quick-nav-btn';
        btn.textContent = folder;
        btn.onclick = () => {
          // Collapse all first
          collapseAll();
          // Find and expand the target folder
          const node = document.querySelector(`[data-path="src/${folder}"]`);
          if (node) {
            const header = node.querySelector('.folder-header');
            const children = node.querySelector('.tree-children');
            if (header) header.classList.remove('collapsed');
            if (children) children.classList.remove('collapsed');
            node.scrollIntoView({ behavior: 'smooth', block: 'start' });

            // Update active state
            document.querySelectorAll('.quick-nav-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
          }
        };
        navContainer.appendChild(btn);
      });
    }

    function renderFileList() {
      const tree = buildTree(files);
      const container = document.getElementById('fileTree');
      container.innerHTML = '';
      renderTree(tree, container, 0);
      renderQuickNav();
    }

    function toggleFile(file, checked) {
      const item = document.querySelector(`[data-file="${file}"]`);
      if (checked) {
        item.classList.add('checked');
      } else {
        item.classList.remove('checked');
      }
      updateStats();
      autoSave();
    }

    function setStatus(file, status) {
      const item = document.querySelector(`[data-file="${file}"]`);
      item.classList.remove('status-keep', 'status-delete', 'status-review');
      if (status) {
        item.classList.add(`status-${status}`);
      }
      updateStats();
      autoSave();
    }

    function autoSave() {
      const data = { ...reviewedFiles };
      document.querySelectorAll('.file-item').forEach(item => {
        const file = item.dataset.file;
        const checked = item.querySelector('input').checked;
        const status = item.querySelector('select').value;
        if (checked || status) {
          data[file] = { checked, status };
        }
      });
      localStorage.setItem('fileReviewProgress', JSON.stringify(data));
    }

    function updateStats() {
      const total = files.length;
      const checked = document.querySelectorAll('.file-item input:checked').length;
      const keep = document.querySelectorAll('.file-item.status-keep').length;
      const del = document.querySelectorAll('.file-item.status-delete').length;
      const review = document.querySelectorAll('.file-item.status-review').length;

      document.getElementById('reviewedCount').textContent = checked;
      document.getElementById('keepCount').textContent = keep;
      document.getElementById('deleteCount').textContent = del;
      document.getElementById('reviewCount').textContent = review;

      // Update progress bar
      const percent = total > 0 ? Math.round((checked / total) * 100) : 0;
      document.getElementById('progressPercent').textContent = `${percent}%`;
      document.getElementById('progressFill').style.width = `${percent}%`;
      document.getElementById('progressText').textContent = `${checked} / ${total} files reviewed`;

      // Update folder progress counts
      const tree = buildTree(files);
      updateFolderProgress(tree);
    }

    function updateFolderProgress(node) {
      if (node.path) {
        const progressEl = document.querySelector(`.folder-progress[data-path="${node.path}"]`);
        if (progressEl) {
          const total = countFiles(node);
          const checked = countCheckedFiles(node, node.path);
          progressEl.textContent = `${checked}/${total}`;
        }
      }
      Object.values(node.children).forEach(child => updateFolderProgress(child));
    }

    function filterFiles() {
      const query = document.getElementById('searchInput').value.toLowerCase();
      const filter = document.getElementById('filterSelect').value;

      document.querySelectorAll('.file-item').forEach(item => {
        const file = item.dataset.file.toLowerCase();
        const isChecked = item.querySelector('input').checked;
        const status = item.querySelector('select').value;

        const matchesSearch = file.includes(query);

        let matchesFilter = true;
        switch (filter) {
          case 'reviewed': matchesFilter = isChecked; break;
          case 'unreviewed': matchesFilter = !isChecked; break;
          case 'keep': matchesFilter = status === 'keep'; break;
          case 'delete': matchesFilter = status === 'delete'; break;
          case 'review': matchesFilter = status === 'review'; break;
        }

        item.style.display = (matchesSearch && matchesFilter) ? 'flex' : 'none';
      });

      // Auto-expand folders with visible files when filtering
      if (query || filter !== 'all') {
        document.querySelectorAll('.tree-node').forEach(node => {
          const hasVisibleFiles = Array.from(node.querySelectorAll('.file-item'))
            .some(item => item.style.display !== 'none');
          if (hasVisibleFiles) {
            const header = node.querySelector('.folder-header');
            const children = node.querySelector('.tree-children');
            if (header) header.classList.remove('collapsed');
            if (children) children.classList.remove('collapsed');
          }
        });
      }
    }

    function expandAll() {
      document.querySelectorAll('.folder-header').forEach(h => h.classList.remove('collapsed'));
      document.querySelectorAll('.tree-children').forEach(c => c.classList.remove('collapsed'));
    }

    function collapseAll() {
      document.querySelectorAll('.folder-header').forEach(h => h.classList.add('collapsed'));
      document.querySelectorAll('.tree-children').forEach(c => c.classList.add('collapsed'));
    }

    function expandToLevel(maxLevel) {
      document.querySelectorAll('.tree-node').forEach(node => {
        const level = parseInt(node.dataset.level) || 0;
        const header = node.querySelector('.folder-header');
        const children = node.querySelector('.tree-children');
        if (level < maxLevel) {
          if (header) header.classList.remove('collapsed');
          if (children) children.classList.remove('collapsed');
        } else {
          if (header) header.classList.add('collapsed');
          if (children) children.classList.add('collapsed');
        }
      });
    }

    function saveProgress() {
      const data = {};
      document.querySelectorAll('.file-item').forEach(item => {
        const file = item.dataset.file;
        const checked = item.querySelector('input').checked;
        const status = item.querySelector('select').value;
        if (checked || status) {
          data[file] = { checked, status };
        }
      });
      localStorage.setItem('fileReviewProgress', JSON.stringify(data));
      alert('Progress saved!');
    }

    function loadProgress() {
      const data = JSON.parse(localStorage.getItem('fileReviewProgress') || '{}');
      Object.entries(data).forEach(([file, { checked, status }]) => {
        const item = document.querySelector(`[data-file="${file}"]`);
        if (item) {
          if (checked) {
            item.querySelector('input').checked = true;
            item.classList.add('checked');
          }
          if (status) {
            item.querySelector('select').value = status;
            item.classList.add(`status-${status}`);
          }
        }
      });
      updateStats();
      alert('Progress loaded!');
    }

    function exportReport() {
      const keep = [], del = [], review = [], unchecked = [];
      document.querySelectorAll('.file-item').forEach(item => {
        const file = item.dataset.file;
        const status = item.querySelector('select').value;
        if (status === 'keep') keep.push(file);
        else if (status === 'delete') del.push(file);
        else if (status === 'review') review.push(file);
        else unchecked.push(file);
      });

      let report = `# File Review Report\nGenerated: ${new Date().toISOString()}\n\n`;
      report += `## Summary\n- Keep: ${keep.length}\n- Delete: ${del.length}\n- Review: ${review.length}\n- Unchecked: ${unchecked.length}\n\n`;

      if (del.length) {
        report += `## Files to Delete (${del.length})\n${del.map(f => '- ' + f).join('\n')}\n\n`;
      }
      if (review.length) {
        report += `## Files Needing Review (${review.length})\n${review.map(f => '- ' + f).join('\n')}\n\n`;
      }
      if (keep.length) {
        report += `## Files to Keep (${keep.length})\n${keep.map(f => '- ' + f).join('\n')}\n\n`;
      }

      const blob = new Blob([report], { type: 'text/markdown' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'file-review-report.md';
      a.click();
    }

    // Pre-defined reviewed files
    const reviewedFiles = {
      "src/middleware.ts": { checked: true, status: "keep" },
      "src/lib/core/auth.ts": { checked: true, status: "keep" },
      "src/lib/core/prisma.ts": { checked: true, status: "keep" },
      "src/lib/core/prisma-tenant.ts": { checked: true, status: "keep" },
      "src/lib/http/approval-handler.ts": { checked: true, status: "keep" },
      "src/lib/http/errors.ts": { checked: true, status: "keep" },
      "src/lib/http/export-handler.ts": { checked: true, status: "keep" },
      "src/lib/http/handler.ts": { checked: true, status: "keep" },
      "src/lib/http/import-handler.ts": { checked: true, status: "keep" },
      "src/lib/http/list-handler.ts": { checked: true, status: "keep" },
      "src/lib/http/responses.ts": { checked: true, status: "keep" },
      "src/lib/modules/access.ts": { checked: true, status: "keep" },
      "src/lib/modules/index.ts": { checked: true, status: "keep" },
      "src/lib/modules/registry.ts": { checked: true, status: "keep" },
      "src/lib/modules/routes.ts": { checked: true, status: "keep" },
      "src/lib/multi-tenant/custom-domain.ts": { checked: true, status: "keep" },
      "src/lib/multi-tenant/feature-flags.ts": { checked: true, status: "keep" },
      "src/lib/multi-tenant/index.ts": { checked: true, status: "keep" },
      "src/lib/multi-tenant/limits.ts": { checked: true, status: "keep" },
      "src/lib/multi-tenant/subdomain.ts": { checked: true, status: "keep" },
      "src/lib/security/account-lockout.ts": { checked: true, status: "keep" },
      "src/lib/security/backup-encryption.ts": { checked: true, status: "keep" },
      "src/lib/security/cron-auth.ts": { checked: true, status: "keep" },
      "src/lib/security/csrf.ts": { checked: true, status: "keep" },
      "src/lib/security/headers.ts": { checked: true, status: "keep" },
      "src/lib/security/impersonation.ts": { checked: true, status: "keep" },
      "src/lib/security/password-validation.ts": { checked: true, status: "keep" },
      "src/lib/security/rateLimit.ts": { checked: true, status: "keep" },
    };

    // Initialize
    renderFileList();
    loadProgress();
  </script>
</body>
</html>
