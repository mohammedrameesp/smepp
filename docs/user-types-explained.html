<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Types, Roles & Database Structure - Durj Platform</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f5f7fa;
      color: #333;
      line-height: 1.6;
      padding: 40px 20px;
    }
    .container { max-width: 1400px; margin: 0 auto; }
    h1 { text-align: center; color: #1a1a2e; margin-bottom: 10px; font-size: 2.5rem; }
    .subtitle { text-align: center; color: #666; margin-bottom: 40px; font-size: 1.1rem; }

    /* Navigation */
    .nav-tabs {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }
    .nav-tab {
      padding: 12px 24px;
      background: white;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    .nav-tab:hover { border-color: #4361ee; color: #4361ee; }
    .nav-tab.active { background: #4361ee; color: white; border-color: #4361ee; }

    /* Tab Content */
    .tab-content { display: none; }
    .tab-content.active { display: block; }

    /* Section Styles */
    .section {
      background: white;
      border-radius: 16px;
      padding: 30px;
      margin-bottom: 30px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    }
    .section h2 {
      color: #1a1a2e;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 3px solid #4361ee;
      display: inline-block;
    }
    .section h3 {
      color: #4361ee;
      margin: 25px 0 15px 0;
      font-size: 1.2rem;
    }

    /* Three Layers Diagram */
    .layers { display: flex; gap: 20px; flex-wrap: wrap; justify-content: center; }
    .layer {
      flex: 1;
      min-width: 300px;
      max-width: 380px;
      border-radius: 12px;
      padding: 25px;
      position: relative;
    }
    .layer-1 { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
    .layer-2 { background: linear-gradient(135deg, #4361ee 0%, #3a0ca3 100%); color: white; }
    .layer-3 { background: linear-gradient(135deg, #f72585 0%, #b5179e 100%); color: white; }
    .layer h3 { font-size: 1.4rem; margin-bottom: 5px; color: white; }
    .layer .model-name {
      font-family: monospace;
      background: rgba(255,255,255,0.2);
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 0.9rem;
      margin-bottom: 15px;
      display: inline-block;
    }
    .layer p { opacity: 0.95; margin-bottom: 15px; }
    .layer ul { list-style: none; }
    .layer li {
      padding: 8px 12px;
      background: rgba(255,255,255,0.15);
      border-radius: 6px;
      margin-bottom: 8px;
      font-size: 0.95rem;
    }
    .layer li code {
      background: rgba(0,0,0,0.2);
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.85rem;
    }

    /* Flags Table */
    .flags-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 25px; }
    .flag-group h4 {
      color: #4361ee;
      margin-bottom: 15px;
      font-size: 1.1rem;
    }
    .flag-table { width: 100%; border-collapse: collapse; }
    .flag-table th, .flag-table td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid #eee;
    }
    .flag-table th {
      background: #f8f9ff;
      color: #4361ee;
      font-weight: 600;
    }
    .flag-table code {
      background: #e8ecff;
      padding: 3px 8px;
      border-radius: 4px;
      color: #3a0ca3;
      font-size: 0.9rem;
    }
    .flag-table tr:hover { background: #fafbff; }

    /* Comparison Cards */
    .comparison { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 20px; }
    .compare-card {
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      transition: all 0.3s ease;
    }
    .compare-card:hover { border-color: #4361ee; transform: translateY(-3px); }
    .compare-card h4 { color: #1a1a2e; margin-bottom: 10px; }
    .compare-card .access {
      font-size: 0.85rem;
      color: #666;
      margin-bottom: 15px;
      padding: 8px;
      background: #f5f7fa;
      border-radius: 6px;
    }
    .compare-card .example {
      font-style: italic;
      color: #888;
      font-size: 0.9rem;
    }
    .badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      margin: 2px;
    }
    .badge-admin { background: #4361ee; color: white; }
    .badge-employee { background: #06d6a0; color: white; }
    .badge-both { background: #f72585; color: white; }
    .badge-system { background: #adb5bd; color: white; }

    /* Flow Diagram */
    .flow {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
      padding: 30px;
      background: #f8f9ff;
      border-radius: 12px;
      margin-top: 20px;
    }
    .flow-box {
      background: white;
      border: 2px solid #4361ee;
      border-radius: 10px;
      padding: 15px 25px;
      text-align: center;
      min-width: 150px;
    }
    .flow-box.highlight { background: #4361ee; color: white; }
    .flow-arrow { font-size: 1.5rem; color: #4361ee; }

    /* Visual Hierarchy */
    .hierarchy {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      padding: 30px;
      background: linear-gradient(180deg, #f8f9ff 0%, #fff 100%);
      border-radius: 12px;
      margin-top: 20px;
    }
    .hierarchy-level {
      display: flex;
      align-items: center;
      gap: 20px;
      width: 100%;
      justify-content: center;
    }
    .hierarchy-box {
      padding: 15px 30px;
      border-radius: 8px;
      font-weight: 600;
      text-align: center;
      min-width: 200px;
    }
    .h-super { background: #f72585; color: white; }
    .h-owner { background: #7209b7; color: white; }
    .h-admin { background: #4361ee; color: white; }
    .h-manager { background: #4cc9f0; color: #1a1a2e; }
    .h-employee { background: #06d6a0; color: #1a1a2e; }
    .hierarchy-arrow { font-size: 1.5rem; color: #adb5bd; }

    /* Routes Section */
    .routes-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
    .route-card {
      border-left: 4px solid #4361ee;
      background: #f8f9ff;
      padding: 20px;
      border-radius: 0 8px 8px 0;
    }
    .route-card h4 { color: #4361ee; margin-bottom: 10px; }
    .route-card code {
      display: block;
      background: #1a1a2e;
      color: #06d6a0;
      padding: 10px 15px;
      border-radius: 6px;
      margin: 10px 0;
      font-size: 0.9rem;
    }
    .route-card p { color: #666; font-size: 0.9rem; }

    /* Summary Box */
    .summary {
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      color: white;
      padding: 30px;
      border-radius: 12px;
      margin-top: 20px;
    }
    .summary h3 { color: #4cc9f0; margin-bottom: 20px; }
    .summary ul { list-style: none; }
    .summary li {
      padding: 10px 0;
      border-bottom: 1px solid rgba(255,255,255,0.1);
      display: flex;
      gap: 15px;
    }
    .summary li:last-child { border-bottom: none; }
    .summary .icon { font-size: 1.2rem; }

    /* Database Tables */
    .db-domain {
      margin-bottom: 30px;
    }
    .db-domain-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid #e0e0e0;
    }
    .db-domain-icon {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.3rem;
    }
    .db-domain-header h3 {
      margin: 0;
      color: #1a1a2e;
    }
    .db-tables {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 15px;
    }
    .db-table {
      background: #f8f9ff;
      border-radius: 10px;
      padding: 15px;
      border-left: 4px solid #4361ee;
    }
    .db-table.core { border-left-color: #f72585; }
    .db-table.junction { border-left-color: #06d6a0; }
    .db-table.history { border-left-color: #ffc107; }
    .db-table h4 {
      font-family: monospace;
      font-size: 1rem;
      color: #3a0ca3;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .db-table h4 .table-badge {
      font-size: 0.65rem;
      padding: 2px 6px;
      border-radius: 10px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-weight: 600;
    }
    .badge-core { background: #f72585; color: white; }
    .badge-junction { background: #06d6a0; color: #1a1a2e; }
    .badge-history { background: #ffc107; color: #1a1a2e; }
    .db-table p {
      font-size: 0.85rem;
      color: #666;
      margin-bottom: 10px;
    }
    .db-table .fields {
      font-size: 0.8rem;
      color: #888;
    }
    .db-table .fields code {
      background: #e8ecff;
      padding: 1px 5px;
      border-radius: 3px;
      color: #4361ee;
      font-size: 0.75rem;
    }

    /* ERD Diagram Styles */
    .erd-container {
      background: #f8f9ff;
      border-radius: 12px;
      padding: 30px;
      margin-top: 20px;
      overflow-x: auto;
    }
    .erd-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 30px;
      min-width: 900px;
    }
    .erd-entity {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.08);
      overflow: hidden;
    }
    .erd-entity-header {
      background: #4361ee;
      color: white;
      padding: 12px 15px;
      font-weight: 600;
      font-family: monospace;
    }
    .erd-entity-header.primary { background: #f72585; }
    .erd-entity-header.secondary { background: #7209b7; }
    .erd-entity-body {
      padding: 15px;
    }
    .erd-field {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 5px 0;
      font-size: 0.85rem;
      border-bottom: 1px solid #f0f0f0;
    }
    .erd-field:last-child { border-bottom: none; }
    .erd-field .key { color: #f72585; font-weight: bold; }
    .erd-field .fk { color: #4361ee; font-weight: bold; }
    .erd-field .type { color: #888; font-size: 0.75rem; margin-left: auto; }

    /* Tenant Isolation Diagram */
    .tenant-diagram {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 20px;
    }
    .tenant-box {
      flex: 1;
      min-width: 300px;
      max-width: 400px;
      background: white;
      border: 2px dashed #4361ee;
      border-radius: 12px;
      padding: 20px;
    }
    .tenant-box h4 {
      color: #4361ee;
      text-align: center;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid #e0e0e0;
    }
    .tenant-data {
      background: #f8f9ff;
      border-radius: 6px;
      padding: 10px;
      margin-bottom: 10px;
      font-size: 0.9rem;
    }
    .tenant-data code {
      background: #4361ee;
      color: white;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.8rem;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Durj Platform Architecture</h1>
    <p class="subtitle">User Types, Roles & Database Structure</p>

    <!-- Navigation Tabs -->
    <div class="nav-tabs">
      <div class="nav-tab active" onclick="showTab('roles')">User Roles</div>
      <div class="nav-tab" onclick="showTab('database')">Database Structure</div>
      <div class="nav-tab" onclick="showTab('erd')">Entity Relationships</div>
      <div class="nav-tab" onclick="showTab('isolation')">Tenant Isolation</div>
    </div>

    <!-- TAB 1: User Roles (Original Content) -->
    <div id="roles" class="tab-content active">
      <!-- Layer Overview -->
      <section class="section">
        <h2>The Three Layers</h2>
        <div class="layers">
          <div class="layer layer-1">
            <h3>Layer 1: User</h3>
            <span class="model-name">User model</span>
            <p>Global authentication account (NextAuth). One per person across all organizations.</p>
            <ul>
              <li><code>isSuperAdmin</code> - Platform admin (manages ALL orgs)</li>
              <li><code>email</code> - Login identifier</li>
              <li><code>passwordHash</code> - For email/password auth</li>
            </ul>
          </div>

          <div class="layer layer-2">
            <h3>Layer 2: TeamMember</h3>
            <span class="model-name">TeamMember model</span>
            <p>Per-organization membership. Contains all permissions and employee data.</p>
            <ul>
              <li><code>isAdmin</code> - Full org access</li>
              <li><code>isEmployee</code> - HR features enabled</li>
              <li><code>canLogin</code> - Can authenticate</li>
              <li><code>hasHRAccess</code>, <code>hasFinanceAccess</code>, etc.</li>
            </ul>
          </div>

          <div class="layer layer-3">
            <h3>Layer 3: OrgRole</h3>
            <span class="model-name">OrgRole enum (Legacy)</span>
            <p>Being deprecated. Used only for approval workflows.</p>
            <ul>
              <li><code>OWNER</code> - Full control</li>
              <li><code>ADMIN</code> - Manage users</li>
              <li><code>MANAGER</code> - Approve requests</li>
              <li><code>MEMBER</code> - Basic access</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- Permission Flags -->
      <section class="section">
        <h2>TeamMember Permission Flags</h2>
        <div class="flags-grid">
          <div class="flag-group">
            <h4>Access Control Flags</h4>
            <table class="flag-table">
              <tr>
                <th>Flag</th>
                <th>Description</th>
              </tr>
              <tr>
                <td><code>isOwner</code></td>
                <td>Organization creator. Cannot be removed.</td>
              </tr>
              <tr>
                <td><code>isAdmin</code></td>
                <td>Full access. Supersedes all other flags.</td>
              </tr>
              <tr>
                <td><code>hasOperationsAccess</code></td>
                <td>Assets, Subscriptions, Suppliers modules</td>
              </tr>
              <tr>
                <td><code>hasHRAccess</code></td>
                <td>Employees, Leave modules</td>
              </tr>
              <tr>
                <td><code>hasFinanceAccess</code></td>
                <td>Payroll, Spend Requests</td>
              </tr>
              <tr>
                <td><code>canApprove</code></td>
                <td>Can approve requests from direct reports</td>
              </tr>
            </table>
          </div>

          <div class="flag-group">
            <h4>Employee Flags</h4>
            <table class="flag-table">
              <tr>
                <th>Flag</th>
                <th>Description</th>
              </tr>
              <tr>
                <td><code>isEmployee</code></td>
                <td>Has HR features (leave, payroll). Default: true</td>
              </tr>
              <tr>
                <td><code>isOnWps</code></td>
                <td>Included in WPS payroll file. Default: true</td>
              </tr>
              <tr>
                <td><code>canLogin</code></td>
                <td>Can authenticate to system. Default: true</td>
              </tr>
            </table>
          </div>
        </div>
      </section>

      <!-- User Type Combinations -->
      <section class="section">
        <h2>Common User Type Combinations</h2>
        <div class="comparison">
          <div class="compare-card">
            <span class="badge badge-admin">ADMIN</span>
            <h4>Admin Only</h4>
            <div class="access">
              <code>isAdmin: true</code><br>
              <code>isEmployee: false</code>
            </div>
            <p>Access: <strong>/admin/*</strong> dashboard</p>
            <p class="example">Example: External HR consultant, IT support</p>
          </div>

          <div class="compare-card">
            <span class="badge badge-employee">EMPLOYEE</span>
            <h4>Employee Only</h4>
            <div class="access">
              <code>isAdmin: false</code><br>
              <code>isEmployee: true</code>
            </div>
            <p>Access: <strong>/employee/*</strong> self-service</p>
            <p class="example">Example: Regular staff, workers</p>
          </div>

          <div class="compare-card">
            <span class="badge badge-both">ADMIN + EMPLOYEE</span>
            <h4>Admin & Employee</h4>
            <div class="access">
              <code>isAdmin: true</code><br>
              <code>isEmployee: true</code>
            </div>
            <p>Access: <strong>Both</strong> dashboards</p>
            <p class="example">Example: Owner on payroll, HR manager</p>
          </div>

          <div class="compare-card">
            <span class="badge badge-system">SYSTEM</span>
            <h4>System Account</h4>
            <div class="access">
              <code>isAdmin: false</code><br>
              <code>isEmployee: false</code>
            </div>
            <p>Access: <strong>None</strong> (cannot login)</p>
            <p class="example">Example: "Warehouse" for unassigned assets</p>
          </div>
        </div>
      </section>

      <!-- Permission Hierarchy -->
      <section class="section">
        <h2>Permission Hierarchy</h2>
        <div class="hierarchy">
          <div class="hierarchy-level">
            <div class="hierarchy-box h-super">Super Admin<br><small>Platform-wide access</small></div>
          </div>
          <div class="hierarchy-arrow">&#9660;</div>
          <div class="hierarchy-level">
            <div class="hierarchy-box h-owner">Owner<br><small>Organization creator</small></div>
          </div>
          <div class="hierarchy-arrow">&#9660;</div>
          <div class="hierarchy-level">
            <div class="hierarchy-box h-admin">Admin<br><small>Full org access</small></div>
          </div>
          <div class="hierarchy-arrow">&#9660;</div>
          <div class="hierarchy-level">
            <div class="hierarchy-box h-manager">Manager (canApprove)<br><small>Approve direct reports</small></div>
          </div>
          <div class="hierarchy-arrow">&#9660;</div>
          <div class="hierarchy-level">
            <div class="hierarchy-box h-employee">Employee<br><small>Self-service only</small></div>
          </div>
        </div>
      </section>

      <!-- Routes -->
      <section class="section">
        <h2>Dashboard Routes by Role</h2>
        <div class="routes-grid">
          <div class="route-card">
            <h4>Super Admin</h4>
            <code>/super-admin/*</code>
            <p>Platform management: all organizations, users, settings, backups</p>
          </div>
          <div class="route-card">
            <h4>Admin Dashboard</h4>
            <code>/admin/*</code>
            <p>Organization management: employees, assets, reports, settings</p>
          </div>
          <div class="route-card">
            <h4>Employee Portal</h4>
            <code>/employee/*</code>
            <p>Self-service: profile, leave requests, payslips, assigned assets</p>
          </div>
        </div>
      </section>

      <!-- Auth Flow -->
      <section class="section">
        <h2>Authentication Flow</h2>
        <div class="flow">
          <div class="flow-box">User logs in</div>
          <span class="flow-arrow">&rarr;</span>
          <div class="flow-box">Check <code>User</code> exists</div>
          <span class="flow-arrow">&rarr;</span>
          <div class="flow-box">Find <code>TeamMember</code><br>for organization</div>
          <span class="flow-arrow">&rarr;</span>
          <div class="flow-box highlight">Session created with<br>roles & permissions</div>
        </div>
      </section>

      <!-- Quick Reference -->
      <section class="section">
        <h2>Quick Reference</h2>
        <div class="summary">
          <h3>Key Takeaways</h3>
          <ul>
            <li>
              <span class="icon">&#128100;</span>
              <span><strong>User</strong> = Global authentication account (one per person)</span>
            </li>
            <li>
              <span class="icon">&#127970;</span>
              <span><strong>TeamMember</strong> = Organization membership with permissions (one per org)</span>
            </li>
            <li>
              <span class="icon">&#128273;</span>
              <span><strong>isAdmin</strong> = Access to /admin/* dashboard</span>
            </li>
            <li>
              <span class="icon">&#128119;</span>
              <span><strong>isEmployee</strong> = Access to HR features (leave, payroll)</span>
            </li>
            <li>
              <span class="icon">&#9989;</span>
              <span><strong>canApprove</strong> = Can approve requests from direct reports</span>
            </li>
            <li>
              <span class="icon">&#127760;</span>
              <span><strong>isSuperAdmin</strong> = Platform-level admin (manages all orgs)</span>
            </li>
          </ul>
        </div>
      </section>
    </div>

    <!-- TAB 2: Database Structure -->
    <div id="database" class="tab-content">
      <section class="section">
        <h2>Database Overview</h2>
        <p style="margin-bottom: 20px; color: #666;">
          The database uses PostgreSQL with Prisma ORM. All tenant-scoped tables include a <code>tenantId</code> column
          that references the <code>Organization</code> table, ensuring complete data isolation between organizations.
        </p>

        <!-- Authentication Domain -->
        <div class="db-domain">
          <div class="db-domain-header">
            <div class="db-domain-icon" style="background: #f72585; color: white;">&#128274;</div>
            <h3>Authentication & Users (Global - Not Tenant-Scoped)</h3>
          </div>
          <div class="db-tables">
            <div class="db-table core">
              <h4>User <span class="table-badge badge-core">CORE</span></h4>
              <p>Global user authentication. One per person across all organizations.</p>
              <div class="fields">
                <code>id</code> <code>email</code> <code>passwordHash</code> <code>isSuperAdmin</code> <code>twoFactorEnabled</code>
              </div>
            </div>
            <div class="db-table">
              <h4>Account</h4>
              <p>OAuth provider accounts (Google, Azure). NextAuth managed.</p>
              <div class="fields">
                <code>userId</code> <code>provider</code> <code>providerAccountId</code> <code>access_token</code>
              </div>
            </div>
            <div class="db-table">
              <h4>Session</h4>
              <p>Active user sessions. NextAuth managed.</p>
              <div class="fields">
                <code>userId</code> <code>sessionToken</code> <code>expires</code>
              </div>
            </div>
            <div class="db-table">
              <h4>VerificationToken</h4>
              <p>Email verification tokens. NextAuth managed.</p>
              <div class="fields">
                <code>identifier</code> <code>token</code> <code>expires</code>
              </div>
            </div>
          </div>
        </div>

        <!-- Multi-Tenant Core -->
        <div class="db-domain">
          <div class="db-domain-header">
            <div class="db-domain-icon" style="background: #7209b7; color: white;">&#127970;</div>
            <h3>Multi-Tenant Core</h3>
          </div>
          <div class="db-tables">
            <div class="db-table core">
              <h4>Organization <span class="table-badge badge-core">CORE</span></h4>
              <p>Tenant (company). All business data links here via tenantId.</p>
              <div class="fields">
                <code>id</code> <code>name</code> <code>slug</code> <code>subscriptionTier</code> <code>enabledModules[]</code> <code>stripeCustomerId</code>
              </div>
            </div>
            <div class="db-table core">
              <h4>TeamMember <span class="table-badge badge-core">CORE</span></h4>
              <p>Unified membership + HR profile. One per user per organization.</p>
              <div class="fields">
                <code>tenantId</code> <code>email</code> <code>isAdmin</code> <code>isEmployee</code> <code>isOwner</code> <code>hasHRAccess</code> <code>hasFinanceAccess</code> <code>salary fields...</code>
              </div>
            </div>
            <div class="db-table">
              <h4>OrganizationInvitation</h4>
              <p>Pending team invitations with expiry tokens.</p>
              <div class="fields">
                <code>organizationId</code> <code>email</code> <code>role</code> <code>token</code> <code>expiresAt</code>
              </div>
            </div>
            <div class="db-table">
              <h4>RolePermission</h4>
              <p>Custom permissions for MANAGER/MEMBER roles.</p>
              <div class="fields">
                <code>tenantId</code> <code>role</code> <code>permission</code>
              </div>
            </div>
            <div class="db-table">
              <h4>OrganizationSetupProgress</h4>
              <p>Onboarding checklist tracking.</p>
              <div class="fields">
                <code>organizationId</code> <code>profileComplete</code> <code>logoUploaded</code> <code>firstAssetAdded</code>
              </div>
            </div>
          </div>
        </div>

        <!-- Operations Module -->
        <div class="db-domain">
          <div class="db-domain-header">
            <div class="db-domain-icon" style="background: #4361ee; color: white;">&#128187;</div>
            <h3>Operations Module (Assets, Subscriptions, Suppliers)</h3>
          </div>
          <div class="db-tables">
            <div class="db-table core">
              <h4>Asset <span class="table-badge badge-core">CORE</span></h4>
              <p>Physical/digital assets with full lifecycle tracking.</p>
              <div class="fields">
                <code>tenantId</code> <code>assetTag</code> <code>type</code> <code>brand</code> <code>model</code> <code>status</code> <code>assignedMemberId</code> <code>depreciation fields...</code>
              </div>
            </div>
            <div class="db-table">
              <h4>AssetCategory</h4>
              <p>Categories for assets (Computing, Furniture, etc.)</p>
              <div class="fields">
                <code>tenantId</code> <code>code</code> <code>name</code> <code>defaultDepreciationCategoryId</code>
              </div>
            </div>
            <div class="db-table">
              <h4>AssetTypeMapping</h4>
              <p>Maps asset types to categories per organization.</p>
              <div class="fields">
                <code>tenantId</code> <code>typeName</code> <code>categoryId</code>
              </div>
            </div>
            <div class="db-table">
              <h4>Location</h4>
              <p>Physical locations for multi-location orgs.</p>
              <div class="fields">
                <code>tenantId</code> <code>name</code> <code>description</code> <code>isActive</code>
              </div>
            </div>
            <div class="db-table history">
              <h4>AssetHistory <span class="table-badge badge-history">HISTORY</span></h4>
              <p>Audit trail for asset changes (assignments, status).</p>
              <div class="fields">
                <code>assetId</code> <code>action</code> <code>fromMemberId</code> <code>toMemberId</code> <code>performedById</code>
              </div>
            </div>
            <div class="db-table">
              <h4>AssetRequest</h4>
              <p>Employee requests, admin assignments, returns.</p>
              <div class="fields">
                <code>tenantId</code> <code>requestNumber</code> <code>type</code> <code>status</code> <code>assetId</code> <code>memberId</code>
              </div>
            </div>
            <div class="db-table">
              <h4>MaintenanceRecord</h4>
              <p>Asset maintenance tracking.</p>
              <div class="fields">
                <code>tenantId</code> <code>assetId</code> <code>maintenanceDate</code> <code>notes</code>
              </div>
            </div>
            <div class="db-table core">
              <h4>Subscription <span class="table-badge badge-core">CORE</span></h4>
              <p>SaaS subscriptions and recurring services.</p>
              <div class="fields">
                <code>tenantId</code> <code>serviceName</code> <code>billingCycle</code> <code>renewalDate</code> <code>status</code> <code>assignedMemberId</code>
              </div>
            </div>
            <div class="db-table history">
              <h4>SubscriptionHistory <span class="table-badge badge-history">HISTORY</span></h4>
              <p>Audit trail for subscription changes.</p>
              <div class="fields">
                <code>subscriptionId</code> <code>action</code> <code>oldStatus</code> <code>newStatus</code>
              </div>
            </div>
            <div class="db-table core">
              <h4>Supplier <span class="table-badge badge-core">CORE</span></h4>
              <p>Vendor/supplier management with approval workflow.</p>
              <div class="fields">
                <code>tenantId</code> <code>suppCode</code> <code>name</code> <code>category</code> <code>status</code> <code>contacts...</code>
              </div>
            </div>
            <div class="db-table">
              <h4>SupplierEngagement</h4>
              <p>Track interactions with suppliers.</p>
              <div class="fields">
                <code>tenantId</code> <code>supplierId</code> <code>date</code> <code>notes</code> <code>rating</code>
              </div>
            </div>
            <div class="db-table">
              <h4>DepreciationCategory</h4>
              <p>Qatar tax rates for asset depreciation.</p>
              <div class="fields">
                <code>tenantId</code> <code>name</code> <code>code</code> <code>annualRate</code> <code>usefulLifeYears</code>
              </div>
            </div>
            <div class="db-table history">
              <h4>DepreciationRecord <span class="table-badge badge-history">HISTORY</span></h4>
              <p>Periodic depreciation calculations per asset.</p>
              <div class="fields">
                <code>tenantId</code> <code>assetId</code> <code>periodStart</code> <code>depreciationAmount</code> <code>netBookValue</code>
              </div>
            </div>
          </div>
        </div>

        <!-- HR Module -->
        <div class="db-domain">
          <div class="db-domain-header">
            <div class="db-domain-icon" style="background: #06d6a0; color: #1a1a2e;">&#128106;</div>
            <h3>HR Module (Leave, Payroll)</h3>
          </div>
          <div class="db-tables">
            <div class="db-table">
              <h4>LeaveType</h4>
              <p>Leave types with Qatar labor law rules.</p>
              <div class="fields">
                <code>tenantId</code> <code>name</code> <code>defaultDays</code> <code>category</code> <code>payTiers</code> <code>minimumServiceMonths</code>
              </div>
            </div>
            <div class="db-table">
              <h4>LeaveBalance</h4>
              <p>Per-employee per-year leave balances.</p>
              <div class="fields">
                <code>tenantId</code> <code>memberId</code> <code>leaveTypeId</code> <code>year</code> <code>entitlement</code> <code>used</code> <code>pending</code>
              </div>
            </div>
            <div class="db-table core">
              <h4>LeaveRequest <span class="table-badge badge-core">CORE</span></h4>
              <p>Employee leave requests with approval workflow.</p>
              <div class="fields">
                <code>tenantId</code> <code>requestNumber</code> <code>memberId</code> <code>leaveTypeId</code> <code>startDate</code> <code>endDate</code> <code>status</code>
              </div>
            </div>
            <div class="db-table history">
              <h4>LeaveRequestHistory <span class="table-badge badge-history">HISTORY</span></h4>
              <p>Audit trail for leave request changes.</p>
              <div class="fields">
                <code>leaveRequestId</code> <code>action</code> <code>oldStatus</code> <code>newStatus</code> <code>performedById</code>
              </div>
            </div>
            <div class="db-table">
              <h4>SalaryStructure</h4>
              <p>Employee salary breakdown (basic + allowances).</p>
              <div class="fields">
                <code>tenantId</code> <code>memberId</code> <code>basicSalary</code> <code>housingAllowance</code> <code>grossSalary</code> <code>effectiveFrom</code>
              </div>
            </div>
            <div class="db-table core">
              <h4>PayrollRun <span class="table-badge badge-core">CORE</span></h4>
              <p>Monthly payroll processing with WPS generation.</p>
              <div class="fields">
                <code>tenantId</code> <code>referenceNumber</code> <code>year</code> <code>month</code> <code>status</code> <code>totalGross</code> <code>wpsFileUrl</code>
              </div>
            </div>
            <div class="db-table">
              <h4>Payslip</h4>
              <p>Individual employee payslips per payroll run.</p>
              <div class="fields">
                <code>tenantId</code> <code>payslipNumber</code> <code>payrollRunId</code> <code>memberId</code> <code>grossSalary</code> <code>netSalary</code>
              </div>
            </div>
            <div class="db-table">
              <h4>PayslipDeduction</h4>
              <p>Line-item deductions on payslips.</p>
              <div class="fields">
                <code>payslipId</code> <code>type</code> <code>description</code> <code>amount</code>
              </div>
            </div>
            <div class="db-table">
              <h4>EmployeeLoan</h4>
              <p>Employee loans/advances with repayment tracking.</p>
              <div class="fields">
                <code>tenantId</code> <code>loanNumber</code> <code>memberId</code> <code>principalAmount</code> <code>monthlyDeduction</code> <code>status</code>
              </div>
            </div>
            <div class="db-table">
              <h4>LoanRepayment</h4>
              <p>Individual loan repayment records.</p>
              <div class="fields">
                <code>loanId</code> <code>amount</code> <code>paymentDate</code> <code>paymentMethod</code>
              </div>
            </div>
          </div>
        </div>

        <!-- Projects Module -->
        <div class="db-domain">
          <div class="db-domain-header">
            <div class="db-domain-icon" style="background: #ffc107; color: #1a1a2e;">&#128203;</div>
            <h3>Projects Module (Spend Requests, Approvals)</h3>
          </div>
          <div class="db-tables">
            <div class="db-table core">
              <h4>PurchaseRequest <span class="table-badge badge-core">CORE</span></h4>
              <p>Purchase/procurement requests with multi-level approval.</p>
              <div class="fields">
                <code>tenantId</code> <code>referenceNumber</code> <code>requesterId</code> <code>status</code> <code>purchaseType</code> <code>totalAmount</code>
              </div>
            </div>
            <div class="db-table">
              <h4>PurchaseRequestItem</h4>
              <p>Line items within a purchase request.</p>
              <div class="fields">
                <code>purchaseRequestId</code> <code>description</code> <code>quantity</code> <code>unitPrice</code> <code>billingCycle</code>
              </div>
            </div>
            <div class="db-table history">
              <h4>PurchaseRequestHistory <span class="table-badge badge-history">HISTORY</span></h4>
              <p>Audit trail for purchase request changes.</p>
              <div class="fields">
                <code>purchaseRequestId</code> <code>action</code> <code>previousStatus</code> <code>newStatus</code>
              </div>
            </div>
            <div class="db-table">
              <h4>ApprovalPolicy</h4>
              <p>Configurable multi-level approval rules.</p>
              <div class="fields">
                <code>tenantId</code> <code>name</code> <code>module</code> <code>minAmount</code> <code>maxAmount</code> <code>isActive</code>
              </div>
            </div>
            <div class="db-table">
              <h4>ApprovalLevel</h4>
              <p>Approval chain levels within a policy.</p>
              <div class="fields">
                <code>policyId</code> <code>levelOrder</code> <code>approverRole</code>
              </div>
            </div>
            <div class="db-table">
              <h4>ApprovalStep</h4>
              <p>Actual approval steps for a request instance.</p>
              <div class="fields">
                <code>tenantId</code> <code>entityType</code> <code>entityId</code> <code>levelOrder</code> <code>approverId</code> <code>status</code>
              </div>
            </div>
          </div>
        </div>

        <!-- System Module -->
        <div class="db-domain">
          <div class="db-domain-header">
            <div class="db-domain-icon" style="background: #adb5bd; color: #1a1a2e;">&#9881;</div>
            <h3>System (Notifications, Activity, Settings)</h3>
          </div>
          <div class="db-tables">
            <div class="db-table">
              <h4>Notification</h4>
              <p>In-app notifications for users.</p>
              <div class="fields">
                <code>tenantId</code> <code>recipientId</code> <code>type</code> <code>title</code> <code>message</code> <code>isRead</code>
              </div>
            </div>
            <div class="db-table">
              <h4>ActivityLog</h4>
              <p>Audit log of all user actions.</p>
              <div class="fields">
                <code>tenantId</code> <code>actorMemberId</code> <code>action</code> <code>entityType</code> <code>entityId</code> <code>payload</code>
              </div>
            </div>
            <div class="db-table">
              <h4>SystemSettings</h4>
              <p>Per-tenant configuration key-value store.</p>
              <div class="fields">
                <code>tenantId</code> <code>key</code> <code>value</code> <code>updatedById</code>
              </div>
            </div>
            <div class="db-table">
              <h4>AppSetting</h4>
              <p>Platform-wide settings (super-admin only, NOT tenant-scoped).</p>
              <div class="fields">
                <code>key</code> <code>value</code>
              </div>
            </div>
            <div class="db-table">
              <h4>ProfileChangeRequest</h4>
              <p>Employee profile update requests.</p>
              <div class="fields">
                <code>tenantId</code> <code>memberId</code> <code>description</code> <code>status</code>
              </div>
            </div>
            <div class="db-table">
              <h4>CompanyDocumentType</h4>
              <p>Types of company documents (CR, Trade License).</p>
              <div class="fields">
                <code>tenantId</code> <code>name</code> <code>code</code> <code>category</code>
              </div>
            </div>
            <div class="db-table">
              <h4>CompanyDocument</h4>
              <p>Company/vehicle documents with expiry tracking.</p>
              <div class="fields">
                <code>tenantId</code> <code>documentTypeName</code> <code>expiryDate</code> <code>documentUrl</code> <code>assetId</code>
              </div>
            </div>
          </div>
        </div>

        <!-- AI & WhatsApp -->
        <div class="db-domain">
          <div class="db-domain-header">
            <div class="db-domain-icon" style="background: #3a0ca3; color: white;">&#129302;</div>
            <h3>AI Chat & WhatsApp Integration</h3>
          </div>
          <div class="db-tables">
            <div class="db-table">
              <h4>ChatConversation</h4>
              <p>AI chat conversation threads.</p>
              <div class="fields">
                <code>tenantId</code> <code>memberId</code> <code>title</code> <code>expiresAt</code>
              </div>
            </div>
            <div class="db-table">
              <h4>ChatMessage</h4>
              <p>Individual messages within conversations.</p>
              <div class="fields">
                <code>conversationId</code> <code>role</code> <code>content</code> <code>functionCalls</code>
              </div>
            </div>
            <div class="db-table">
              <h4>AIChatUsage</h4>
              <p>Token usage tracking for billing.</p>
              <div class="fields">
                <code>tenantId</code> <code>memberId</code> <code>promptTokens</code> <code>completionTokens</code> <code>costUsd</code>
              </div>
            </div>
            <div class="db-table">
              <h4>AIChatAuditLog</h4>
              <p>Security audit log for AI queries.</p>
              <div class="fields">
                <code>tenantId</code> <code>queryHash</code> <code>functionsCalled</code> <code>flagged</code> <code>riskScore</code>
              </div>
            </div>
            <div class="db-table">
              <h4>WhatsAppConfig</h4>
              <p>Per-tenant WhatsApp Business API credentials.</p>
              <div class="fields">
                <code>tenantId</code> <code>phoneNumberId</code> <code>accessTokenEncrypted</code> <code>isActive</code>
              </div>
            </div>
            <div class="db-table">
              <h4>WhatsAppUserPhone</h4>
              <p>Map members to WhatsApp numbers.</p>
              <div class="fields">
                <code>tenantId</code> <code>memberId</code> <code>phoneNumber</code> <code>isVerified</code>
              </div>
            </div>
            <div class="db-table">
              <h4>WhatsAppActionToken</h4>
              <p>One-time tokens for approval button callbacks.</p>
              <div class="fields">
                <code>tenantId</code> <code>token</code> <code>entityType</code> <code>action</code> <code>expiresAt</code>
              </div>
            </div>
            <div class="db-table">
              <h4>WhatsAppMessageLog</h4>
              <p>Message delivery status logging.</p>
              <div class="fields">
                <code>tenantId</code> <code>messageId</code> <code>templateName</code> <code>status</code>
              </div>
            </div>
            <div class="db-table">
              <h4>PlatformWhatsAppConfig</h4>
              <p>Platform-wide WhatsApp config (super-admin only).</p>
              <div class="fields">
                <code>phoneNumberId</code> <code>businessAccountId</code> <code>displayPhoneNumber</code>
              </div>
            </div>
          </div>
        </div>

        <!-- Platform Admin -->
        <div class="db-domain">
          <div class="db-domain-header">
            <div class="db-domain-icon" style="background: #f72585; color: white;">&#128737;</div>
            <h3>Platform Administration (Super-Admin Only)</h3>
          </div>
          <div class="db-tables">
            <div class="db-table">
              <h4>RevokedImpersonationToken</h4>
              <p>Track revoked impersonation JWT tokens.</p>
              <div class="fields">
                <code>jti</code> <code>revokedBy</code> <code>superAdminId</code> <code>organizationId</code> <code>expiresAt</code>
              </div>
            </div>
            <div class="db-table">
              <h4>Feedback</h4>
              <p>User feedback/bug reports (not tenant-scoped).</p>
              <div class="fields">
                <code>organizationId</code> <code>submittedByEmail</code> <code>type</code> <code>message</code> <code>status</code>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- TAB 3: Entity Relationships -->
    <div id="erd" class="tab-content">
      <section class="section">
        <h2>Key Entity Relationships</h2>
        <p style="margin-bottom: 20px; color: #666;">
          Visual representation of the core data model relationships. The TeamMember model is central to most business operations.
        </p>

        <div class="erd-container">
          <div class="erd-grid">
            <!-- Organization -->
            <div class="erd-entity">
              <div class="erd-entity-header primary">Organization</div>
              <div class="erd-entity-body">
                <div class="erd-field"><span class="key">PK</span> id <span class="type">cuid</span></div>
                <div class="erd-field">name <span class="type">String</span></div>
                <div class="erd-field">slug <span class="type">String (unique)</span></div>
                <div class="erd-field">subscriptionTier <span class="type">Enum</span></div>
                <div class="erd-field">enabledModules[] <span class="type">String[]</span></div>
                <div class="erd-field">stripeCustomerId <span class="type">String?</span></div>
              </div>
            </div>

            <!-- TeamMember -->
            <div class="erd-entity">
              <div class="erd-entity-header secondary">TeamMember</div>
              <div class="erd-entity-body">
                <div class="erd-field"><span class="key">PK</span> id <span class="type">cuid</span></div>
                <div class="erd-field"><span class="fk">FK</span> tenantId <span class="type">&#8594; Organization</span></div>
                <div class="erd-field">email <span class="type">String</span></div>
                <div class="erd-field">isOwner, isAdmin <span class="type">Boolean</span></div>
                <div class="erd-field">isEmployee <span class="type">Boolean</span></div>
                <div class="erd-field">hasHRAccess, hasFinanceAccess <span class="type">Boolean</span></div>
                <div class="erd-field"><span class="fk">FK</span> reportingToId <span class="type">&#8594; TeamMember</span></div>
                <div class="erd-field">employeeCode, department <span class="type">String?</span></div>
              </div>
            </div>

            <!-- User -->
            <div class="erd-entity">
              <div class="erd-entity-header">User (Global Auth)</div>
              <div class="erd-entity-body">
                <div class="erd-field"><span class="key">PK</span> id <span class="type">cuid</span></div>
                <div class="erd-field">email <span class="type">String (unique)</span></div>
                <div class="erd-field">passwordHash <span class="type">String?</span></div>
                <div class="erd-field">isSuperAdmin <span class="type">Boolean</span></div>
                <div class="erd-field">twoFactorEnabled <span class="type">Boolean</span></div>
              </div>
            </div>

            <!-- Asset -->
            <div class="erd-entity">
              <div class="erd-entity-header">Asset</div>
              <div class="erd-entity-body">
                <div class="erd-field"><span class="key">PK</span> id <span class="type">cuid</span></div>
                <div class="erd-field"><span class="fk">FK</span> tenantId <span class="type">&#8594; Organization</span></div>
                <div class="erd-field">assetTag <span class="type">String (unique/tenant)</span></div>
                <div class="erd-field"><span class="fk">FK</span> categoryId <span class="type">&#8594; AssetCategory</span></div>
                <div class="erd-field"><span class="fk">FK</span> assignedMemberId <span class="type">&#8594; TeamMember</span></div>
                <div class="erd-field">status <span class="type">Enum</span></div>
                <div class="erd-field">price, depreciation... <span class="type">Decimal</span></div>
              </div>
            </div>

            <!-- LeaveRequest -->
            <div class="erd-entity">
              <div class="erd-entity-header">LeaveRequest</div>
              <div class="erd-entity-body">
                <div class="erd-field"><span class="key">PK</span> id <span class="type">cuid</span></div>
                <div class="erd-field"><span class="fk">FK</span> tenantId <span class="type">&#8594; Organization</span></div>
                <div class="erd-field">requestNumber <span class="type">String (unique/tenant)</span></div>
                <div class="erd-field"><span class="fk">FK</span> memberId <span class="type">&#8594; TeamMember</span></div>
                <div class="erd-field"><span class="fk">FK</span> leaveTypeId <span class="type">&#8594; LeaveType</span></div>
                <div class="erd-field">startDate, endDate <span class="type">DateTime</span></div>
                <div class="erd-field">status <span class="type">Enum</span></div>
                <div class="erd-field"><span class="fk">FK</span> approverId <span class="type">&#8594; TeamMember</span></div>
              </div>
            </div>

            <!-- PayrollRun -->
            <div class="erd-entity">
              <div class="erd-entity-header">PayrollRun</div>
              <div class="erd-entity-body">
                <div class="erd-field"><span class="key">PK</span> id <span class="type">cuid</span></div>
                <div class="erd-field"><span class="fk">FK</span> tenantId <span class="type">&#8594; Organization</span></div>
                <div class="erd-field">referenceNumber <span class="type">String (unique/tenant)</span></div>
                <div class="erd-field">year, month <span class="type">Int</span></div>
                <div class="erd-field">status <span class="type">Enum</span></div>
                <div class="erd-field">totalGross, totalNet <span class="type">Decimal</span></div>
                <div class="erd-field">wpsFileUrl <span class="type">String?</span></div>
              </div>
            </div>
          </div>
        </div>

        <h3 style="margin-top: 30px;">Relationship Summary</h3>
        <div class="summary" style="margin-top: 15px;">
          <ul>
            <li><span class="icon">&#127970;</span><strong>Organization &#8594; TeamMember</strong>: One-to-Many. Each org has many team members.</li>
            <li><span class="icon">&#128100;</span><strong>TeamMember &#8594; TeamMember</strong>: Self-referential (reportingToId). Manager hierarchy.</li>
            <li><span class="icon">&#128187;</span><strong>TeamMember &#8594; Asset</strong>: One-to-Many via assignedMemberId. Member can have many assets.</li>
            <li><span class="icon">&#128197;</span><strong>TeamMember &#8594; LeaveRequest</strong>: One-to-Many. Member can have many leave requests.</li>
            <li><span class="icon">&#128176;</span><strong>PayrollRun &#8594; Payslip</strong>: One-to-Many. Each payroll run generates payslips for all employees.</li>
            <li><span class="icon">&#128203;</span><strong>PurchaseRequest &#8594; PurchaseRequestItem</strong>: One-to-Many. Each PR has multiple line items.</li>
            <li><span class="icon">&#128269;</span><strong>All tenant tables &#8594; Organization</strong>: Many-to-One via tenantId. Ensures data isolation.</li>
          </ul>
        </div>
      </section>
    </div>

    <!-- TAB 4: Tenant Isolation -->
    <div id="isolation" class="tab-content">
      <section class="section">
        <h2>Multi-Tenant Data Isolation</h2>
        <p style="margin-bottom: 20px; color: #666;">
          Every business entity table includes a <code>tenantId</code> column. The Prisma client extension automatically
          filters all queries by tenant, preventing cross-tenant data access.
        </p>

        <div class="tenant-diagram">
          <div class="tenant-box">
            <h4>&#127970; Acme Corp (Tenant A)</h4>
            <div class="tenant-data">
              <code>tenantId: "org_abc123"</code><br>
              10 TeamMembers<br>
              45 Assets<br>
              3 PayrollRuns
            </div>
            <div class="tenant-data">
              Queries auto-filtered:<br>
              <code style="background: #06d6a0;">WHERE tenantId = 'org_abc123'</code>
            </div>
          </div>

          <div class="tenant-box">
            <h4>&#127970; Beta LLC (Tenant B)</h4>
            <div class="tenant-data">
              <code>tenantId: "org_xyz789"</code><br>
              25 TeamMembers<br>
              120 Assets<br>
              12 PayrollRuns
            </div>
            <div class="tenant-data">
              Queries auto-filtered:<br>
              <code style="background: #06d6a0;">WHERE tenantId = 'org_xyz789'</code>
            </div>
          </div>
        </div>

        <h3 style="margin-top: 30px;">How Tenant Isolation Works</h3>
        <div class="flow" style="margin-top: 15px;">
          <div class="flow-box">Request arrives</div>
          <span class="flow-arrow">&rarr;</span>
          <div class="flow-box">Middleware extracts<br><code>x-tenant-id</code> header</div>
          <span class="flow-arrow">&rarr;</span>
          <div class="flow-box">Prisma extension<br>wraps all queries</div>
          <span class="flow-arrow">&rarr;</span>
          <div class="flow-box highlight">Auto-adds<br><code>WHERE tenantId = ?</code></div>
        </div>

        <h3 style="margin-top: 30px;">Tenant-Scoped vs Global Tables</h3>
        <table class="flag-table" style="margin-top: 15px;">
          <tr>
            <th>Type</th>
            <th>Tables</th>
            <th>Description</th>
          </tr>
          <tr>
            <td><span class="badge badge-admin">Tenant-Scoped</span></td>
            <td>Asset, TeamMember, LeaveRequest, PayrollRun, Notification, etc.</td>
            <td>Have <code>tenantId</code> column. Auto-filtered by Prisma extension.</td>
          </tr>
          <tr>
            <td><span class="badge badge-system">Global (Auth)</span></td>
            <td>User, Account, Session, VerificationToken</td>
            <td>NextAuth tables. One User can be TeamMember in multiple orgs.</td>
          </tr>
          <tr>
            <td><span class="badge badge-both">Platform-Wide</span></td>
            <td>AppSetting, Feedback, PlatformWhatsAppConfig, RevokedImpersonationToken</td>
            <td>Super-admin managed. Not tied to any organization.</td>
          </tr>
        </table>

        <h3 style="margin-top: 30px;">Reference Number Patterns</h3>
        <p style="color: #666; margin-bottom: 15px;">
          Each tenant has unique reference numbers generated with their org prefix:
        </p>
        <table class="flag-table">
          <tr>
            <th>Entity</th>
            <th>Pattern</th>
            <th>Example</th>
          </tr>
          <tr>
            <td>Asset</td>
            <td><code>{PREFIX}-{CAT}-{YYSEQ}</code></td>
            <td>BCE-CP-25001</td>
          </tr>
          <tr>
            <td>Leave Request</td>
            <td><code>{PREFIX}-LR-{SEQ}</code></td>
            <td>BCE-LR-00042</td>
          </tr>
          <tr>
            <td>Spend Request</td>
            <td><code>{PREFIX}-PR-{YYMM}-{SEQ}</code></td>
            <td>BCE-PR-2501-0003</td>
          </tr>
          <tr>
            <td>Payroll Run</td>
            <td><code>{PREFIX}-PAY-{YYYY}-{MM}-{SEQ}</code></td>
            <td>BCE-PAY-2025-01-001</td>
          </tr>
          <tr>
            <td>Payslip</td>
            <td><code>{PREFIX}-PS-{YYYY}-{MM}-{SEQ}</code></td>
            <td>BCE-PS-2025-01-00015</td>
          </tr>
          <tr>
            <td>Supplier</td>
            <td><code>SUPP-{SEQ}</code></td>
            <td>SUPP-0001</td>
          </tr>
          <tr>
            <td>Employee Loan</td>
            <td><code>{PREFIX}-LOAN-{SEQ}</code></td>
            <td>BCE-LOAN-00003</td>
          </tr>
        </table>
      </section>
    </div>
  </div>

  <script>
    function showTab(tabId) {
      // Hide all tab contents
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
      });
      // Remove active from all nav tabs
      document.querySelectorAll('.nav-tab').forEach(nav => {
        nav.classList.remove('active');
      });
      // Show selected tab
      document.getElementById(tabId).classList.add('active');
      // Add active to clicked nav
      event.target.classList.add('active');
    }
  </script>
</body>
</html>
